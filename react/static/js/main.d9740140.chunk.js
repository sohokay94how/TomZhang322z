(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(t,e,s){},16:function(t,e,s){},24:function(t,e,s){t.exports=s.p+"static/media/logo.5d5d9eef.svg"},26:function(t,e,s){t.exports=s(60)},32:function(t,e,s){},34:function(t,e,s){},60:function(t,e,s){"use strict";s.r(e);var i=s(0),o=s.n(i),a=s(23),r=s.n(a),n=(s(32),s(4)),l=s(1),h=s(6),c=s(5),p=s(7),d=s(63),u=s(64),f=s(61),m=s(24),g=s.n(m),$=(s(34),function(t){function e(){return Object(n.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("img",{src:g.a,className:"App-logo",alt:"logo"}),o.a.createElement("p",null," Edit ",o.a.createElement("code",null,"src/App.js")," and save to reload. "),o.a.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"},"Learn React")))}}]),e}(i.Component)),v=s(2),y=function(t){return t||(t=window.event),t.pageX||t.pageY?{x:t.pageX,y:t.pageY}:{x:t.clientX+document.documentElement.scrollLeft-document.body.clientLeft,y:t.clientY+document.documentElement.scrollTop-document.body.clientTop}},b=function(t){var e=t.offsetTop,s=t.offsetLeft;for(t=t.offsetParent;t;)e+=t.offsetTop,s+=t.offsetLeft,t=t.offsetParent;return{top:e,left:s}},w=y,x=b,k=function(t,e){var s=y(t),i=b(e);return{X:s.x-i.left+e.parentNode.scrollLeft,Y:s.y-i.top+e.parentNode.scrollTop}},M=function(t,e,s,i,o,a,r){r||(r=1);var n,l,h={left:t.left*r,top:t.top*r,width:t.width*r,height:t.height*r},c={left:e.left*r,top:e.top*r,width:e.width*r,height:e.height*r},p=o*r,d=i*r,u=a*r,f={x:h.left+h.width/2,y:h.top+h.height/2},m={x:c.left+c.width/2,y:c.top+c.height/2},g=[],$=[],v=[],y=[];return n=[f.x,f.y],l=[m.x,m.y],"lr"===s?($=[p,d],v=[p,u],y=[m.x,u],(g=[f.x,d])[1]>h.top&&g[1]<h.top+h.height?(g[0]=$[0]<f.x?h.left:h.left+h.width,n[0]=g[0],n[1]=g[1]):n[1]=g[1]<h.top?h.top:h.top+h.height,g[0]===n[0]&&g[1]===n[1]&&($[0]>h.left&&$[0]<h.left+h.width?($[1]=f.y>v[1]?h.top:h.top+h.height,n[0]=$[0],n[1]=$[1],g[0]=$[0],g[1]=$[1]):(n[0]=$[0]<h.left?h.left:h.left+h.width,g[0]=n[0])),y[1]>c.top&&y[1]<c.top+c.height?(y[0]=v[0]>m.x?c.left+c.width:c.left,l[0]=y[0],l[1]=y[1]):l[1]=y[1]<c.top?c.top:c.top+c.height,y[0]===l[0]&&y[1]===l[1]&&(v[0]>c.left&&v[0]<c.left+c.width?(v[1]=m.y>$[1]?c.top:c.top+c.height,l[0]=v[0],l[1]=v[1],y[0]=v[0],y[1]=v[1]):(l[0]=v[0]<c.left?c.left:c.left+c.width,y[0]=l[0]))):"tb"===s&&($=[d,p],v=[u,p],y=[u,m.y],(g=[d,f.y])[0]>h.left&&g[0]<h.left+h.width?(g[1]=$[1]<f.y?h.top:h.top+h.height,n[0]=g[0],n[1]=g[1]):n[0]=g[0]<h.left?h.left:h.left+h.width,g[0]===n[0]&&g[1]===n[1]&&($[1]>h.top&&$[1]<h.top+h.height?($[0]=f.x>v[0]?h.left:h.left+h.width,n[0]=$[0],n[1]=$[1],g[0]=$[0],g[1]=$[1]):(n[1]=$[1]<h.top?h.top:h.top+h.height,g[1]=n[1])),y[0]>c.left&&y[0]<c.left+c.width?(y[1]=v[1]>m.y?c.top+c.height:c.top,l[0]=y[0],l[1]=y[1]):l[0]=y[0]<c.left?c.left:c.left+c.width,y[0]===l[0]&&y[1]===l[1]&&(v[1]>c.top&&v[1]<c.top+c.height?(v[0]=m.x>$[0]?c.left:c.left+c.width,l[0]=v[0],l[1]=v[1],y[0]=v[0],y[1]=v[1]):(l[1]=v[1]<c.top?c.top:c.top+c.height,y[1]=l[1]))),{start:n,m0:g,m1:$,m2:v,m3:y,end:l}},_=function(t,e,s,i){return i||(i=1),"lr"===s?(t.left*i+t.width*i/2+e.left*i+e.width*i/2)/2:"tb"===s?(t.top*i+t.height*i/2+e.top*i+e.height*i/2)/2:void 0},N=function(t,e,s){var i,o,a,r;s||(s=1);var n=t.left*s,l=t.left*s+t.width*s,h=e.left*s,c=e.left*s+e.width*s;n>=c?(i=n,a=c):l<=h?(i=l,a=h):n<=h&&l>=h&&l<=c?a=i=(l+h)/2:n>=h&&l<=c?a=i=(n+l)/2:h>=n&&c<=l?a=i=(h+c)/2:n<=c&&l>=c&&(a=i=(n+c)/2);var p=t.top*s,d=t.top*s+t.height*s,u=e.top*s,f=e.top*s+e.height*s;return p>=f?(o=p,r=f):d<=u?(o=d,r=u):p<=u&&d>=u&&d<=f?r=o=(d+u)/2:p>=u&&d<=f?r=o=(p+d)/2:u>=p&&f<=d?r=o=(u+f)/2:p<=f&&d>=f&&(r=o=(p+f)/2),{start:[i,o],end:[a,r]}},O=function(t,e,s,i){if(s[0]!==e[0]||s[1]!==e[1]){for(var o="",a=[s[0],s[1]],r=0;r<a.length;++r){var n=(a[r]-e[r])/2;n>0?a[r]-=t>n?n:t:n<0&&(a[r]+=t>-n?-n:t)}o+=" L "+a[0]+" "+a[1]+" Q "+s[0]+" "+s[1],a=[s[0],s[1]];for(var l=0;l<a.length;++l){var h=(a[l]-i[l])/2;h>0?a[l]-=t>h?h:t:h<0&&(a[l]+=t>-h?-h:t)}return o+=" "+a[0]+" "+a[1]}},E=function(t){t||(t=window.event),window.event?t.cancelBubble=!0:t.stopPropagation()},C=function(t){var e="object"===typeof t?t.state.$nowType:t;return"direct"===e||"dirDashed"===e||"segment"===e||"segDashed"===e},A=function(t){var e=null;try{e=getComputedStyle(t,"style")}catch(s){e=t.style}return e},S=function(t,e){for(var s=0;s<e.length;++s)if(t===e[s])return!0;return!1},F=function(t,e,s,i,o){"function"===typeof o&&t.addEventListener(e,function(e){e||(e=window.event);for(var a=t.querySelectorAll(s),r=e.target;r!==t&&!S(r,a);)r=r.parentNode;return r&&r!==t&&(e.data=i,!1===o(e,r)&&function(t){t||(t=window.event),window.event?t.cancelBubble=!0:t.stopPropagation()}(e)),!1})},L={hasClass:function(t,e){return 0!==(e=e||"").replace(/\s/g,"").length&&new RegExp(" "+e+" ").test(" "+t.className+" ")},addClass:function(t,e){this.hasClass(t,e)||(t.className=""===t.className?e:t.className+" "+e)},removeClass:function(t,e){if(this.hasClass(t,e)){for(var s=" "+t.className.replace(/[\t\r\n]/g,"")+" ";s.indexOf(" "+e+" ")>=0;)s=s.replace(" "+e+" "," ");t.className=s.replace(/^\s+|\s+$/g,"")}},css:function(t,e){for(var s in e)t.style[s]=e[s]}},D={_renameTxtHide:function(){this.$refs.$textArea.value="",this.$refs.$textArea.removeAttribute("data-id"),this.$refs.$textArea.style.display="none"},_renameTxtShow:function(t){for(var e in t)this.$refs.$textArea.style[e]="number"===typeof t[e]?t[e]+"px":t[e];this.$refs.$textArea.style.display="block"},_renderHeadBtnClick:function(t){switch(t){case"ico_new":null!==this.onBtnNewClick&&this.onBtnNewClick();break;case"ico_open":null!==this.onBtnOpenClick&&this.onBtnOpenClick();break;case"ico_save":null!==this.onBtnSaveClick&&this.onBtnSaveClick();break;case"ico_undo":this.undo();break;case"ico_redo":this.redo();break;case"ico_reload":null!==this.onFreshClick&&this.onFreshClick();break;case"ico_print":null!==this.onPrintClick&&this.onPrintClick();break;default:var e=t.split("ico_")[1];"undefined"!==typeof this.$headBtnEvents&&"function"===typeof this.$headBtnEvents[e]&&this.$headBtnEvents[e].call(this)}},_initOperStack:function(){this.$isUndo=0,this.pushOper=function(t,e){1===this.$isUndo?(this.$redoStack.push([t,e]),this.$isUndo=0,this.$redoStack.length>50&&this.$redoStack.shift(),this.$refs.$head&&this.$refs.$head._checkStack(this.$undoStack,this.$redoStack,"redo")):(this.$undoStack.push([t,e]),this.$undoStack.length>50&&this.$undoStack.shift(),0===this.$isUndo&&this.$redoStack.splice(0,this.$redoStack.length),this.$isUndo=0,this.$refs.$head&&this.$refs.$head._checkStack(this.$undoStack,this.$redoStack))},this.pushExternalOper=function(t,e){this.pushOper("externalFunc",[t,e])},this.undo=function(){if(0!==this.$undoStack.length){this.blurItem();var t=this.$undoStack.pop();this.$isUndo=1,"externalFunc"===t[0]?t[1][0](t[1][1]):this[t[0]].apply(this,t[1]),this.$refs.$head&&this.$refs.$head._checkStack(this.$undoStack,this.$redoStack)}},this.redo=function(){if(0!==this.$redoStack.length){this.blurItem();var t=this.$redoStack.pop();this.$isUndo=2,"externalFunc"===t[0]?t[1][0](t[1][1]):this[t[0]].apply(this,t[1]),this.$refs.$head&&this.$refs.$head._checkStack(this.$undoStack,this.$redoStack)}}},_node2Area:function(t){if(this.extFlag.group){var e=this.state.$nodes[t],s=!1;for(var i in this.state.$areas){var o=this.state.$areas[i];if(e.left>=o.left&&e.left<o.left+o.width&&e.top>=o.top&&e.top<o.top+o.height){this.state.$nodes[t].areaId=i,s=!0;break}}s||delete this.state.$nodes[t].areaId}},_setPolyCoor:function(t,e,s,i,o,a){var r=this.state.$lines[t];if(!r||e<0||r[s]===e||!r.type||"sl"===r.type)return!1;if(!1!==o&&"function"===typeof this.onLineMove&&!1===this.onLineMove(t,e,s||"M"))return!1;if("function"===typeof this.pushOper&&!i){var n=[t,r[s]];this.pushOper("setLine"+s,n)}r[s]=e,this.$editable&&(r.alt=!0),this.state.$lines[t]=r,this.setState({$lines:this.state.$lines}),!a&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})},_resetLines:function(t){var e=this.state.$lines,s=!1;for(var i in e)e[i].from!==t&&e[i].to!==t||(s=!0);s&&this.setState({$lines:e})},_suitSize:function(){var t=0,e=0;for(var s in this.state.$nodes){var i=this.state.$nodes[s];t<i.width+i.left&&(t=i.width+i.left),e<i.height+i.top&&(e=i.height+i.top)}if(null!=this.$group)for(var o in this.state.$areas){var a=this.state.$areas[o];t<a.width+a.left&&(t=a.width+a.left),e<a.height+a.top&&(e=a.height+a.top)}for(var r in this.state.$lines){var n=this.state.$lines[r];""!==n.M&&"lt"===n.type&&t<n.M&&(t=n.M+4),""!==n.M&&"tb"===n.type&&e<n.M&&(e=n.M+4)}if(null!=this.$paper)for(var l in this.state.$memos){var h=this.state.$memos[l];t<h.width+h.left&&(t=h.width+h.left),e<h.height+h.top&&(e=h.height+h.top)}return{width:t*this.scale,height:e*this.scale}},_buildWorkSize:function(){for(var t=this.$refs.$workArea.parentNode,e=t.offsetWidth,s=t.offsetHeight,i=this._suitSize();i.width>e;)e+=this.$workExtendStep;for(;i.height>s;)s+=this.$workExtendStep;return{width:e,height:s,haveData:i.width>0&&i.height>0}},_bindMoveEvent:function(t,e,s,i,o,a){var r=w(t),n=this.t;i||(i="move");var l=this.$refs.$workArea,h=0,c=0,p=t.id,d=r.x-n.left+l.parentNode.scrollLeft,u=r.y-n.top+l.parentNode.scrollTop,f=this.$refs.$ghost;"move"!==i?(f.show({width:e.width*this.scale+"px",height:e.height*this.scale+"px",top:e.top*this.scale+n.top-l.parentNode.scrollTop+"px",left:e.left*this.scale+n.left-l.parentNode.scrollLeft+"px",cursor:i}),h=e.left*this.scale+e.width*this.scale-d,c=e.top*this.scale+e.height*this.scale-u):(h=d-e.left*this.scale,c=u-e.top*this.scale);var m=!1,g=this;document.onmousemove=function(t){t||(t=window.event);var s=w(t);if("move"!==i)switch(d=s.x-n.left+l.parentNode.scrollLeft-e.left*g.scale+h,u=s.y-n.top+l.parentNode.scrollTop-e.top*g.scale+c,d<o*g.scale&&(d=o*g.scale),u<a*g.scale&&(u=a*g.scale),i){case"nw-resize":f.show({width:d+"px",height:u+"px"});break;case"w-resize":f.show({width:d+"px"});break;case"n-resize":f.show({height:u+"px"})}else{if(d===s.x-h&&u===s.y-c)return E(t),!1;d=s.x-h,u=s.y-c,f.inShow()||f.css({width:e.width*g.scale+"px",height:e.height*g.scale+"px",top:e.top*g.scale+n.top-l.parentNode.scrollTop+"px",left:e.left*g.scale+n.left-l.parentNode.scrollLeft+"px",cursor:"move"}),m&&f.show(),d<n.left-l.parentNode.scrollLeft&&!e.canOver?d=n.left-l.parentNode.scrollLeft:d+l.parentNode.scrollLeft+e.width*g.scale>n.left+l.offsetWidth&&!e.canOver&&(d=n.left+l.offsetWidth-l.parentNode.scrollLeft-e.width*g.scale),u<n.top-l.parentNode.scrollTop&&!e.canOver?u=n.top-l.parentNode.scrollTop:u+l.parentNode.scrollTop+e.height*g.scale>n.top+l.offsetHeight&&!e.canOver&&(u=n.top+l.offsetHeight-l.parentNode.scrollTop-e.height*g.scale),m?f.show({left:d+"px",top:u+"px"}):f.css({left:d+"px",top:u+"px"}),g.extFlag.autoalign;var r=g._locAlignLine(p,f,g.state.$nowType);g._magnetic(f,r),d=parseInt(f.$el.style.left.split("px")[0],10),u=parseInt(f.$el.style.top.split("px")[0],10)}m=!0},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null;var t=(d+l.parentNode.scrollLeft-n.left)/g.scale,e=(u+l.parentNode.scrollTop-n.top)/g.scale,o=f.offsetSize();f.$el.innerHTML="",f.hide();var a=o.width/g.scale,r=o.height/g.scale;g.extFlag.autoalign,g.$refs.$alignH.style.display="none",g.$refs.$alignV.style.display="none",s&&"function"===typeof s&&s(m,g,i,t,e,a,r)}},_initDraw:function(){var t=this;F(this.$refs.$draw,"click","g",{},function(e,s){t.$multiKey&&t._isMultiKey(e)?(t.state.$focus===s.id&&t.blurItem(),t.$editable&&t.$multiLines&&(t.$multiLines[s.id]?t._removeFromMultiList(s.id,"line",!0):t._addtoMultiList(s.id,"line",!0))):t.state.$focus!==s.id?t.focusItem(s.id,!0):t.$refs.$lineOper.setTid(s.id)}),this.$editable&&(F(this.$refs.$draw,"contextmenu","g",{},function(e,s){if("function"===typeof t.onItemRightClick&&!1===t.onItemRightClick(s.id,"line"))return e.preventDefault(),!1}),F(this.$refs.$draw,"dblclick","g",{},function(e,s){if("function"!==typeof t.onItemDbClick||!1!==t.onItemDbClick(s.id,"line")){var i=s.querySelector("text").textContent,o=s.getAttribute("from").split(","),a=s.getAttribute("to").split(",");"lr"===t.state.$lines[s.id].type?(o[0]=t.state.$lines[s.id].M*t.scale,a[0]=o[0]):"tb"===t.state.$lines[s.id].type&&(o[1]=t.state.$lines[s.id].M*t.scale,a[1]=o[1]);var r=(parseInt(o[0],10)+parseInt(a[0],10))/2-64,n=(parseInt(o[1],10)+parseInt(a[1],10))/2-18,l=t.t;t.$refs.$textArea.value=i,t._renameTxtShow({width:130,height:26,left:l.left+r-t.$refs.$workArea.parentNode.scrollLeft,top:l.top+n-t.$refs.$workArea.parentNode.scrollTop}),t.$refs.$textArea.setAttribute("data-id",t.state.$focus),t.$refs.$textArea.focus(),t.$refs.$workArea.parentNode.onmousedown=function(e){t.$refs.$workArea.parentNode.onmousedown=null,2!==e.button?(t.setName(t.$refs.$textArea.getAttribute("data-id"),t.$refs.$textArea.value,"line"),t._renameTxtHide()):E(e)}}}))},_initWorkForNode:function(){var t=this;F(this.$refs.$workArea,"click",".GooFlow_item",{},function(e,s){t.state.$focus===s.id||t.$multiKey&&t._isMultiKey(e)?L.hasClass(e.target,"rs_close")&&t.$editable?t.delNode(s.id):t.$multiKey&&t._isMultiKey(e)&&(t.state.$focus===s.id&&t.blurItem(),t.$editable&&t.$multiNodes&&(t.$multiNodes[s.id]?t._removeFromMultiList(s.id,"node",!0):t._addtoMultiList(s.id,"node",!0))):t.focusItem(s.id,!0),E(e)}),F(this.$refs.$workArea,"contextmenu",".GooFlow_item",{},function(e,s){if("function"===typeof t.onItemRightClick&&!1===t.onItemRightClick(s.id,"node"))return E(e),!1});var e=function(t){t.$refs.$workArea.parentNode.onmousedown=function(e){if(t.$refs.$workArea.parentNode.onmousedown=null,2!==e.button){var s=t.$refs.$textArea;t.setName(s.getAttribute("data-id"),s.value,"node"),t._renameTxtHide()}else E(e)}};F(this.$refs.$workArea,"dblclick",".GooFlow_item",{},function(s,i){var o=i.id;if("function"===typeof t.onItemDbClick&&!1===t.onItemDbClick(o,"node"))return!1;if(t.$editable){var a=s.target,r=t.t,n=t.$refs.$textArea,l="";if("DIV"===a.tagName.toUpperCase()&&L.hasClass(a,"span"))l=a.innerHTML,n.value=l,t._renameTxtShow({height:i.offsetHeight+6,width:100,left:r.left+t.state.$nodes[o].left*t.scale-t.$refs.$workArea.parentNode.scrollLeft-26,top:r.top+t.state.$nodes[o].top*t.scale-t.$refs.$workArea.parentNode.scrollTop+26}),n.setAttribute("data-id",t.state.$focus),n.focus(),e(t);else if("DIV"===a.tagName.toUpperCase()&&"TD"===a.parentNode.tagName.toUpperCase()&&L.hasClass(a.parentNode.previousSibling,"ico")||"TD"===a.tagName.toUpperCase()&&L.hasClass(a.previousSibling,"ico")){var h=i.querySelector(".ico + td");l=h.childNodes[0].innerHTML,n.value=l,t._renameTxtShow({width:h.offsetWidth+26,height:h.offsetHeight+6,left:r.left+26+t.state.$nodes[o].left*t.scale-t.$refs.$workArea.parentNode.scrollLeft,top:r.top+2+t.state.$nodes[o].top*t.scale-t.$refs.$workArea.parentNode.scrollTop}),n.setAttribute("data-id",t.state.$focus),n.focus(),e(t)}}}),this.$editable&&(F(this.$refs.$workArea,"mousedown",".GooFlow_item",{},function(e,s){if(2===e.button)return!1;var i=e.target;if(C(t)){var o,a,r=w(e),n=x(t.$refs.$workArea);o=r.x-n.left+t.$refs.$workArea.parentNode.scrollLeft,a=r.y-n.top+t.$refs.$workArea.parentNode.scrollTop,t.lineStart={x:o,y:a,id:s.id},t.$refs.$tmpLine.setState2({d:"M "+o+" "+a+" L "+o+" "+a,display:"block",dash:"dirDashed"===t.state.$nowType||"segDashed"===t.state.$nowType,noArrow:"segment"===t.state.$nowType||"segDashed"===t.state.$nowType}),E(e)}else if("TD"===i.tagName||"TD"===i.parentNode.tagName){if(C(t))return;if("cursor"===t.state.$nowType&&t.$refs.$multiGhost&&t.$refs.$multiGhost.inShow())return;var l=s.childNodes[0].cloneNode(!0);t.$refs.$ghost.append(l),e.id=s.id,t._bindMoveEvent(e,t.state.$nodes[s.id],function(t,e,i,o,a){t&&e.moveNode(s.id,o,a),s.id!==e.state.$focus&&e.focusItem(s.id,!0)})}else if("DIV"===i.tagName.toUpperCase()&&(L.hasClass(i,"rs_bottom")||L.hasClass(i,"rs_right")||L.hasClass(i,"rs_rb"))){var h=L.hasClass(i,"rs_bottom")?"n-resize":L.hasClass(i,"rs_right")?"w-resize":"nw-resize";if("pointer"===h)return;var c=t.state.$focus;t.switchToolBtn("cursor"),E(e),t.$refs.$ghost.$el.style.cursor=h;var p=t.state.$nodes[c];t._bindMoveEvent(e,p,function(t,e,s,i,o,a,r){t&&e.resizeNode(c,a,r)},h,104,26)}}),F(this.$refs.$workArea,"mouseup",".GooFlow_item",{},function(e,s){if(C(t)||t.$refs.$mpTo.getP()){var i=t.lineStart,o=t.lineEnd;if(i&&!t.$refs.$mpTo.getP()){var a={from:i.id,to:s.id,name:"",M:"",type:"sl"};"dirDashed"!==t.state.$nowType&&"segDashed"!==t.state.$nowType||(a.dash=!0),"segment"!==t.state.$nowType&&"segDashed"!==t.state.$nowType||(a.noArrow=!0),t.addLine((new Date).getTime(),a),t.$max++}else i?t.moveLinePoints(t.state.$focus,i.id,s.id):o&&t.moveLinePoints(t.state.$focus,s.id,o.id)}}))},_initEditFunc:function(){var t=this;this.$refs.$workArea.addEventListener("mousemove",function(e){if((C(t)||t.$refs.$mpTo.getP())&&(t.lineStart||t.lineEnd)){var s=w(e),i=x(this),o=s.x-i.left+this.parentNode.scrollLeft,a=s.y-i.top+this.parentNode.scrollTop,r=t.$refs.$tmpLine.getState2();t.lineStart?r.d="M "+t.lineStart.x+" "+t.lineStart.y+" L "+o+" "+a:t.lineEnd&&(r.d="M "+o+" "+a+" L "+t.lineEnd.x+" "+t.lineEnd.y),r.noArrow="segment"===t.state.$nowType||"segDashed"===t.state.$nowType,r.dash="dirDashed"===t.state.$nowType||"segDashed"===t.state.$nowType,t.$refs.$tmpLine.setState2(r)}}),this.$refs.$workArea.addEventListener("mouseup",function(e){if(C(t)||t.$refs.$mpTo.getP()){var s=t.$refs.$tmpLine.getState2();"none"!==s.display?(delete t.lineStart,delete t.lineEnd,s.display="none",t.$refs.$tmpLine.setState2(s),t.$refs.$mpTo.hide(),t.$refs.$mpFrom.hide(),t.focusItem(t.state.$focus,!1)):t.$refs.$lineOper.setTid(0)}}),this.$refs.$workArea.addEventListener("keydown",function(e){if(!t.$refs.$ghost.inShow()&&"none"===t.$refs.$textArea.style.display)switch(e.keyCode){case 46:if(""!==t.state.$focus)t.delNode(t.state.$focus,!0),t.delLine(t.state.$focus);else if("cursor"===t.state.$nowType&&t.$refs.$multiGhost&&t.$refs.$multiGhost.inShow()){var s=[],i=[];for(var o in t.$multiNodes)s.push(o);for(var a in t.$multiLines)i.push(a);t.batchDelete(s,i),t._wallAllMulti()}break;case 67:if(e.ctrlKey){if(!t.state.$nodes[t.state.$focus])return;t.copyNode(t.state.$focus)}break;case 86:if(e.ctrlKey){if(!t.$clipNode||null==t.$clipNode)return;t.parseNode()}}})},_initExpendFunc:function(){var t=this.$workExtendStep,e=this.$refs.$workArea,s=this,i=this.$refs.$workArea.parentNode;this.$refs.$extendRight.addEventListener("click",function(o){e.style.width=e.offsetWidth+t+"px",s.$refs.$alignV&&(s.$refs.$alignV.style.width=e.style.width),i.scrollLeft=i.scrollWidth,i.style.overflow="scroll",E(o)}),this.$refs.$extendBottom.addEventListener("click",function(o){e.style.height=e.offsetHeight+t+"px",s.$refs.$alignH&&(s.$refs.$alignH.style.height=e.style.height),i.scrollTop=i.scrollHeight,i.style.overflow="scroll",E(o)})},_renderClick:function(t){t||(t=window.event);var e=this.state.$nowType;if("cursor"!==e){if("direct"!==e&&"segment"!==e&&"dirDashed"!==e&&"segDashed"!==e&&"group"!==e&&"memo"!==e&&this.$editable&&!this.$dragAddOper){var s=k(t,this.$refs.$workArea);this.addNode((new Date).getTime(),{name:this.$nodePrefix+this.$max,left:s.X/this.scale,top:s.Y/this.scale,type:this.state.$nowType}),this.$max++}}else{var i=t.target,o=i.tagName.toUpperCase();if("SVG"===o||"DIV"===o&&i.className.indexOf("GooFlow_work")>-1||"LABEL"===o)if(this.$refs.$lineOper&&this.$refs.$lineOper.getTid())this.focusItem(this.$refs.$lineOper.getTid(),!1);else if(this.extFlag.multi){var a=Object.keys(this.$multiNodes),r=Object.keys(this.$multiLines);0===a.length&&1===r.length?(delete this.$multiLines[r],this.focusItem(r[0],!0)):1===a.length&&0===r.length?(delete this.$multiNodes[a],this.focusItem(a[0],!0)):0===a.length&&0===r.length&&this.blurItem()}else this.inMulti()&&this.$editable||this.blurItem()}},_bindScrollScaleEvent:function(){var t=this,e=function(e){var s=0;if((e=e||window.event).wheelDelta&&e.ctrlKey)s=-1*e.wheelDelta;else{if(!e.detail||!e.ctrlKey)return;s=e.detail}e.preventDefault();var i=s>0?-.1:s<0?.1:0;t.resetScale(t.scale+i)};document.addEventListener&&this.$el.addEventListener("DOMMouseScroll",e,!1),this.$el.onmousewheel=e}},j={bindHeadBtnEvent:function(t){this.opts.haveHead&&Object.assign(this.$headBtnEvents,t)},bindOperEvent:function(t){if("object"===typeof t)for(var e in t)"function"===typeof t[e]&&(this[e]=t[e])},switchToolBtn:function(t){t!==this.state.$nowType&&(this.$dragAddOper&&"cursor"!==t&&!C(t)&&"group"!==t&&"memo"!==t||(this.state.$nowType=t,this.setState({$nowType:t}),"cursor"!==t&&this.blurItem()))},setDragAddOper:function(t){this.$dragAddOper=t||!1},setNodeCustoms:function(t){Object.assign(this.$nodeCustoms,t)},setTitle:function(t){this.$title=t,this.$refs.$head.setTitle(t)},addNode:function(t,e,s,i,o,a){!1!==s&&"function"===typeof this.onItemAdd&&!1===this.onItemAdd(t,"node",e)||("function"===typeof this.pushOper&&this.$editable&&!i&&this.pushOper("delNode",[t]),this.state.$nodes[t]=e,a||this.setState({$nodes:this.state.$nodes}),++this.$nodeCount,this.$editable&&(this.state.$nodes[t].alt=!0,this.$deletedItem[t]&&delete this.$deletedItem[t]),!o&&this.$navMap&&this.$nextTick(function(){this.refreshMap()}))},moveNode:function(t,e,s,i,o,a){if(this.state.$nodes[t]&&(!1===i||"function"!==typeof this.onItemMove||!1!==this.onItemMove(t,"node",e,s))){var r=this.state.$nodes[t];if("function"===typeof this.pushOper&&this.$editable&&!o){var n=[t,r.left,r.top];this.pushOper("moveNode",n)}e<0&&(e=0),s<0&&(s=0),r.left=e,r.top=s,this._resetLines(t),this.state.$nodes[t]=r;var l=document.getElementById(t);l.style.left=e*this.scale+"px",l.style.top=s*this.scale+"px",this.$editable&&(this.state.$nodes[t].alt=!0,this._node2Area(t)),!a&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},resizeNode:function(t,e,s){if(this.state.$nodes[t]&&("function"!==typeof this.onItemResize||!1!==this.onItemResize(t,"node",e,s))){var i=this.state.$nodes[t].type,o=this.$nodeTypeMap[i]||i;if(!(o.indexOf(" round")>0||o.indexOf(" rhomb")>0||this.$nodeCustoms[i])){if("function"===typeof this.pushOper){var a=[t,this.state.$nodes[t].width,this.state.$nodes[t].height];this.pushOper("resizeNode",a)}var r=this.state.$nodes[t],n=document.getElementById(t);n.childNodes[0].style.width=e*this.scale-2+"px",n.childNodes[0].style.height=s*this.scale-2+"px",r.width=n.offsetWidth/this.scale,r.height=n.offsetHeight/this.scale,n.childNodes[0].style.height=r.height*this.scale-2+"px",this.$editable&&(r.alt=!0),this.state.$nodes[t]=r,this._resetLines(t),this._node2Area(t),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}}},copyNode:function(t){this.$clipNode=this.getItemInfo(t,"node")},parseNode:function(){this.$clipNode&&null!=this.$clipNode&&(this.$clipNode.top+=30,this.$clipNode.left+=30,this.addNode((new Date).getTime(),JSON.parse(JSON.stringify(this.$clipNode))))},delNode:function(t,e,s,i){if(this.state.$nodes[t]&&(!1===e||"function"!==typeof this.onItemDel||!1!==this.onItemDel(t,"node"))){for(var o in this.state.$lines)this.state.$lines[o].from!==t&&this.state.$lines[o].to!==t||this.delLine(o,!1);if("function"===typeof this.pushOper&&!s){var a=[t,this.state.$nodes[t]];this.pushOper("addNode",a)}delete this.state.$nodes[t],this.setState({$nodes:this.state.$nodes}),--this.$nodeCount,this.state.$focus===t&&(this.state.$focus=""),this.$editable&&(this.$deletedItem[t]="node"),!i&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},addLine:function(t,e,s,i,o,a){if(e.from!==e.to){var r=this.state.$nodes[e.from],n=this.state.$nodes[e.to];r&&n&&(!1!==s&&"function"===typeof this.onItemAdd&&!1===this.onItemAdd(t,"line",e)||("function"===typeof this.pushOper&&this.$editable&&!i&&this.pushOper("delLine",[t]),e.M||(e.M=""),(!e.type||"lr"!==e.type&&"tb"!==e.type)&&(e.type="sl"),e.marked||(e.marked=!1),this.state.$lines[t]=e,a||this.setState({$lines:this.state.$lines}),++this.$lineCount,this.$editable&&(this.state.$lines[t].alt=!0,this.$deletedItem[t]&&delete this.$deletedItem[t]),!o&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})))}},setLineM:function(t,e,s,i,o){this._setPolyCoor(t,e,"M",s,i,o)},setLineMl:function(t,e,s,i,o){this._setPolyCoor(t,e,"Ml",s,i,o)},setLineMr:function(t,e,s,i,o){this._setPolyCoor(t,e,"Mr",s,i,o)},setLineStyle:function(t,e){var s="direct",i=this.state.$lines[t];if(!i)return!1;if(i.dash&&(s="dirDashed"),i.noArrow&&(s=i.dash?"segDashed":"segment"),!e||e===s||"direct"!==e&&"dirDashed"!==e&&"segment"!==e&&"segDashed"!==e)return!1;if("function"!==typeof this.onLineSetStyle||!1!==this.onLineSetStyle(t,e)){switch(e){case"direct":i.dash=!1,i.noArrow=!1;break;case"dirDashed":i.dash=!0,i.noArrow=!1;break;case"segment":i.dash=!1,i.noArrow=!0;break;case"segDashed":i.dash=!0,i.noArrow=!0;break;default:return}var o=document.getElementById(t).querySelectorAll("path")[1];if(i.dash?o.setAttribute("style","stroke-dasharray:5,6"):o.removeAttribute("style"),i.noArrow?o.removeAttribute("marker-end"):i.marked?o.setAttribute("marker-end","url(#arrow2)"):o.setAttribute("marker-end","url(#arrow1)"),this.$undoStack){var a=[t,s];this.pushOper("setLineStyle",a)}if(this.$editable&&(i.alt=!0),this.state.$focus===t){var r=this;this.$nextTick(function(){r.focusItem(t)})}this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},setLineType:function(t,e,s){var i=this.state.$lines[t];if(!e||null==e||""===e||!i||e===i.type)return!1;if("function"!==typeof this.onLineSetType||!1!==this.onLineSetType(t,e)){if("function"===typeof this.pushOper){var o=[t,i.type||"sl",i.M];this.pushOper("setLineType",o)}var a=i.from,r=i.to,n=this.state.$nodes[a],l=this.state.$nodes[r];if(i.type=e,this.$editable&&(i.alt=!0),"sl"!==e?(s||(s=_(n,l,e)),"lr"===e?(i.Ml=n.top+n.height/2,i.Mr=l.top+l.height/2):(i.Ml=n.left+n.width/2,i.Mr=l.left+l.width/2),this.setLineM(t,s,!0,!1)):(i.M="",i.Ml="",i.Mr="",this.state.$lines[t]=i,this.setState({$lines:this.state.$lines}),this.$refs.$lineMove.hide(),this.$refs.$lineMoveL.hide(),this.$refs.$lineMoveR.hide()),this.state.$focus===t){var h=this;this.$nextTick(function(){h.focusItem(t)})}this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},moveLinePoints:function(t,e,s,i){if(e!==s&&t&&this.state.$lines[t]){for(var o in null!=e&&""!==e||(e=this.state.$lines[t].from),null!=s&&""!==s||(s=this.state.$lines[t].to),this.state.$lines)if(e===this.state.$lines[o].from&&s===this.state.$lines[o].to)return;if("function"!==typeof this.onLinePointMove||!1!==this.onLinePointMove(t,e,s)){if("function"===typeof this.pushOper&&!i){var a=[t,this.state.$lines[t].from,this.state.$lines[t].to];this.pushOper("moveLinePoints",a)}var r=this.state.$lines[t];null!=e&&""!==e&&(r.from=e),null!=s&&""!==s&&(r.to=s),this.$editable&&(r.alt=!0),this.state.$lines[t]=r,this.setState({$lines:this.state.$lines}),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}}},delLine:function(t,e,s,i){if(this.state.$lines[t]&&(!1===e||"function"!==typeof this.onItemDel||!1!==this.onItemDel(t,"line"))){if("function"===typeof this.pushOper&&!s){var o=[t,this.state.$lines[t]];this.pushOper("addLine",o)}delete this.state.$lines[t],this.setState({$lines:this.state.$lines}),--this.$lineCount,this.$editable&&(this.$deletedItem[t]="line",this.state.$focus===t&&(this.$refs.$mpFrom.hide(),this.$refs.$mpTo.hide(),this.$refs.$lineMove.hide(),this.$refs.$lineMoveL.hide(),this.$refs.$lineMoveR.hide(),this.$refs.$lineOper&&this.$refs.$lineOper.hide())),this.state.$focus===t&&(this.state.$focus=""),!i&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},blurItem:function(t,e){if(""!==this.state.$focus){var s=this.state.$focus;if("DIV"===document.getElementById(s).tagName.toUpperCase()){if(delete this.$clipNode,!t&&"function"===typeof this.onItemBlur&&!1===this.onItemBlur(this.state.$focus,"node"))return!1}else{if(!t&&"function"===typeof this.onItemBlur&&!1===this.onItemBlur(this.state.$focus,"line"))return!1;this.$editable&&(this.$refs.$lineMove.hide(),this.$refs.$lineMoveL.hide(),this.$refs.$lineMoveR.hide(),this.$refs.$lineOper.hide(),this.$refs.$mpFrom.hide(),this.$refs.$mpTo.hide())}}else this.$editable&&this.$multiNodes&&this._clearMultiList();return e||(this.state.$focus="",this.setState({$focus:this.state.$focus})),!0},focusItem:function(t,e){if(t&&null!=t&&""!==t){var s=document.getElementById(t);if(null!=s&&this.blurItem(!e,!0)){if("DIV"===s.tagName.toUpperCase()){if(e&&"function"===typeof this.onItemFocus&&!1===this.onItemFocus(t,"node"))return;this.state.$focus=t}else{if(e&&"function"===typeof this.onItemFocus&&!1===this.onItemFocus(t,"line"))return;if(this.state.$focus=t,!this.$editable)return;var i=this.state.$lines[t],o=s.getAttribute("from").split(","),a=s.getAttribute("to").split(",");o[0]=parseInt(o[0],10),o[1]=parseInt(o[1],10),a[0]=parseInt(a[0],10),a[1]=parseInt(a[1],10);var r=[o[0],o[1],a[0],a[1]];"lr"===i.type?(this.$refs.$lineMove.show({width:"5px",height:Math.abs(i.Ml-i.Mr)*this.scale+"px",left:i.M*this.scale-3+"px",top:(i.Mr>i.Ml?i.Ml:i.Mr)*this.scale+1+"px",cursor:"e-resize",display:"block"}),this.$refs.$lineMove.setData({type:"lr",tid:t}),this.$refs.$lineMoveL.show({height:"5px",width:Math.abs(o[0]-i.M)*this.scale+"px",top:i.Ml*this.scale-3+"px",left:(i.M>o[0]?o[0]:i.M)*this.scale+1+"px",cursor:"s-resize",display:"block"}),this.$refs.$lineMoveL.setData({type:"lr",tid:t}),this.$refs.$lineMoveR.show({height:"5px",width:Math.abs(a[0]-i.M)*this.scale+"px",top:i.Mr*this.scale-3+"px",left:(i.M>a[0]?a[0]:i.M)*this.scale+1+"px",cursor:"s-resize",display:"block"}),this.$refs.$lineMoveR.setData({type:"lr",tid:t}),o[0]=i.M*this.scale,a[0]=o[0]):"tb"===i.type?(this.$refs.$lineMove.show({width:Math.abs(i.Ml-i.Mr)*this.scale+"px",height:"5px",left:(i.Mr>i.Ml?i.Ml:i.Mr)+1+"px",top:i.M*this.scale-3+"px",cursor:"s-resize",display:"block"}),this.$refs.$lineMove.setData({type:"tb",tid:t}),this.$refs.$lineMoveL.show({height:Math.abs(o[1]-i.M)*this.scale+"px",width:"5px",top:(i.M>o[1]?o[1]:i.M)+1+"px",left:i.Ml*this.scale-3+"px",cursor:"e-resize",display:"block"}),this.$refs.$lineMoveL.setData({type:"tb",tid:t}),this.$refs.$lineMoveR.show({height:Math.abs(a[1]-i.M)*this.scale+"px",width:"5px",top:(i.M>a[1]?a[1]:i.M)+1+"px",left:i.Mr*this.scale-3+"px",cursor:"e-resize",display:"block"}),this.$refs.$lineMoveR.setData({type:"tb",tid:t}),o[1]=i.M*this.scale,a[1]=o[1]):(this.$refs.$lineMove.hide(),this.$refs.$lineMove.setData({}),this.$refs.$lineMoveL.hide(),this.$refs.$lineMoveL.setData({}),this.$refs.$lineMoveR.hide(),this.$refs.$lineMoveR.setData({}));var n=(o[0]+a[0])/2-40,l=(o[1]+a[1])/2+4,h=this.$refs.$lineOper;h.show({display:"block",left:n+"px",top:l+"px"}),h.setTid(t),(h=this.$refs.$mpFrom).show({left:r[0]-4+"px",top:r[1]-4+"px"}),h.setP(r[0]+","+r[1]),(h=this.$refs.$mpTo).show({left:r[2]-4+"px",top:r[3]-4+"px"}),h.setP(r[2]+","+r[3])}this.setState({$focus:t}),this.switchToolBtn("cursor")}}},setItemExtra:function(t,e,s){if(null!=t&&""!==t&&null!=e&&""!==e){var i="node"===e?this.state.$nodes[t]:"line"===e?this.state.$lines[t]:"area"===e?this.state.$areas[t]:this.state.$memos[t];for(var o in s)i[o]=s[o]}},delItemExtra:function(t,e,s){if(null!=t&&""!==t&&null!=e&&""!==e)for(var i="node"===e?this.state.$nodes[t]:"line"===e?this.state.$lines[t]:"area"===e?this.state.$areas[t]:this.state.$memos[t],o=0;o<s.length;++o)delete i[s[o]]},getItemInfo:function(t,e){switch(e){case"node":return JSON.parse(JSON.stringify(this.state.$nodes[t]||null));case"line":return JSON.parse(JSON.stringify(this.state.$lines[t]||null));case"area":return JSON.parse(JSON.stringify(this.state.$areas[t]||null));case"memo":return JSON.parse(JSON.stringify(this.state.$memos[t]||null));default:return JSON.parse(JSON.stringify(this.state.$nodes[t]||this.state.$lines[t]||this.state.$areas[t]||this.state.$memos[t]||null))}},markItem:function(t,e,s,i,o,a){if("node"===e){if(!this.state.$nodes[t])return;if(!1!==i&&"function"===typeof this.onItemMark&&!1===this.onItemMark(t,"node",s))return;var r=this.state.$nodes[t];r.marked=s||!1,this.state.$nodes[t]=r,this.setState({$nodes:this.state.$nodes})}else{if("line"!==e)return;if(!this.state.$lines[t])return;if(!1!==i&&"function"===typeof this.onItemMark&&!1===this.onItemMark(t,"line",s))return;var n=this.state.$lines[t];n.marked=s||!1,this.state.$lines[t]=n,this.setState({$lines:this.state.$lines})}if("function"===typeof this.pushOper&&!o){var l=[t,e,!s];this.pushOper("markItem",l)}!a&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})},setItemColor:function(t,e,s,i,o){if(null!=t&&""!==t&&null!=e&&""!==e){var a="";if("node"===e){a=document.getElementById(t).style.backgroundColor;var r=JSON.parse(JSON.stringify(this.state.$nodes[t]));r.color=s,this.state.$nodes[t]=r,this.setState({$nodes:this.state.$nodes})}else{if("line"!==e)return;a=this.state.$lines[t].color;var n=JSON.parse(JSON.stringify(this.state.$lines[t]));n.color=s,this.state.$lines[t]=n,this.setState({$lines:this.state.$lines})}"function"!==typeof this.pushOper||i||this.pushOper("setItemColor",[t,e,a]),!o&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},setItemFontColor:function(t,e,s,i){if(null!=t&&""!==t&&null!=e&&""!==e){var o="";if("node"===e){var a=JSON.parse(JSON.stringify(this.state.$nodes[t])),r=this.$nodeTypeMap[a.type]||a.type;o=a.fontColor||(r.indexOf(" mix")>-1?this.GooFlow.color.mixFont:this.GooFlow.color.font),a.fontColor=s,this.state.$nodes[t]=a,this.setState({$nodes:this.state.$nodes})}else{if("line"!==e)return;var n=JSON.parse(JSON.stringify(this.state.$lines[t]));o=n.fontColor||this.GooFlow.color.lineFont,n.fontColor=s,this.state.$lines[t]=n,this.setState({$lines:this.state.$lines})}"function"!==typeof this.pushOper||i||this.pushOper("setItemFontColor",[t,e,o])}},setName:function(t,e,s,i){var o="";if("node"===s){if(!this.state.$nodes[t])return;if(this.state.$nodes[t].name===e)return;if("function"===typeof this.onItemRename&&!1===this.onItemRename(t,e,"node"))return;var a=this.state.$nodes[t];o=a.name;var r=!1,n=document.getElementById(t),l=this.$nodeTypeMap[a.type]||a.type;if(l.indexOf(" round")<0&&l.indexOf(" rhomb")<0&&!this.$nodeCustoms[a.type]){n.querySelector("td div").innerText=e;var h=n.offsetWidth/this.scale,c=n.offsetHeight/this.scale;a.width===h&&a.height===c||("function"===typeof this.pushOper&&this.pushOper("resizeNode",[t,a.width,a.height]),a.width=h,a.height=c,r=!0)}else n.querySelector(".span").innerText=e;a.name=e,this.$editable&&(a.alt=!0),this.state.$nodes[t]=a,r&&this._resetLines(t),!i&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}else if("line"===s){if(!this.state.$lines[t])return;if(this.state.$lines[t].name===e)return;if("function"===typeof this.onItemRename&&!1===this.onItemRename(t,e,"line"))return;var p=JSON.parse(JSON.stringify(this.state.$lines[t]));o=p.name,p.name=e,this.$editable&&(p.alt=!0),this.state.$lines[t]=p,this.setState({$lines:this.state.$lines})}else{if("area"!==s)return;if(!this.state.$areas[t])return;if(this.state.$areas[t].name===e)return;if("function"===typeof this.onItemRename&&!1===this.onItemRename(t,e,"area"))return;var d=this.state.$areas[t];o=d.name,d.name=e,this.$editable&&(d.alt=!0),this.state.$areas[t]=d,document.getElementById(t).querySelector("label").innerHTML=e}"function"===typeof this.pushOper&&this.pushOper("setName",[t,o,s])},setExtra:function(t){if("object"===typeof t)for(var e in t)this.$extra[e]=t[e]},getExtra:function(){return this.$extra},loadData:function(t){for(var e in this.clearData(!0),this.setTitle(t.title),this.$deletedItem={},this.$extra=t.extra,this.$max="undefined"===typeof t.initNum?1:t.initNum,t.nodes)this.addNode(e,t.nodes[e],!1,!0,!0,!0);for(var s in t.lines)this.addLine(s,t.lines[s],!1,!0,!0,!0);if(this.extFlag.group&&t.areas)for(var i in t.areas)this.addArea(i,t.areas[i],!1,!0,!0,!0);if(this.extFlag.memo&&t.memos)for(var o in t.memos)this.addMemo(o,t.memos[o],!1,!0,!0,!0);this.$deletedItem={},this.$extra=t.extra;var a=this._buildWorkSize();this.$refs.$workArea.style.width=a.width+"px",this.$refs.$workArea.style.height=a.height+"px",this.$refs.$alignV&&(this.$refs.$alignV.style.width=a.width+"px"),this.$refs.$alignH&&(this.$refs.$alignH.style.height=a.height+"px"),this.setState({$focus:""}),this.$navMap&&this.$nextTick(function(){this.refreshMap()})},exportData:function(){var t={title:this.$title,nodes:{},lines:{}};for(var e in t.initNum=this.$max,this.state.$nodes)t.nodes[e]=JSON.parse(JSON.stringify(this.state.$nodes[e])),t.nodes[e].marked||delete t.nodes[e].marked;for(var s in this.state.$lines)t.lines[s]=JSON.parse(JSON.stringify(this.state.$lines[s])),t.lines[s].marked||delete t.lines[s].marked,""===t.lines[s].M&&delete t.lines[s].M;if(this.extFlag.group)for(var i in t.areas={},this.state.$areas)t.areas[i]=JSON.parse(JSON.stringify(this.state.$areas[i]));if(this.extFlag.memo)for(var o in t.memos={},this.state.$memos)t.memos[o]=JSON.parse(JSON.stringify(this.state.$memos[o]));for(var a in t.extra={},this.$extra)t.extra[a]=JSON.parse(JSON.stringify(this.$extra[a]));return t},exportAlter:function(){var t={nodes:{},lines:{}};for(var e in this.state.$nodes)this.state.$nodes[e].alt&&(t.nodes[e]=this.state.$nodes[e]);for(var s in this.state.$lines)this.state.$lines[s].alt&&(t.lines[s]=this.state.$lines[s]);if(this.extFlag.group)for(var i in t.areas={},this.state.$areas)this.state.$areas[i].alt&&(t.areas[i]=this.state.$areas[i]);if(this.extFlag.memo)for(var o in t.memos={},this.state.$memos)this.state.$memos[o].alt&&(t.memos[o]=this.state.$memos[o]);return t.deletedItem=this.$deletedItem,t},transNewId:function(t,e,s){t!==this.state.$focus||"node"!==s&&"line"!==s||(this.state.$focus=e);var i=null,o=null;switch(s){case"node":o=this.state.$nodes;break;case"line":o=this.state.$lines;break;case"area":o=this.state.$areas;break;case"memo":o=this.state.$memos}if(null!=o&&o[t]){i=JSON.parse(JSON.stringify(o[t])),delete o[t],o[e]=i;var a={};if(a["$"+s+"s"]=o,this.setState(a),"area"===s)for(var r in this.state.$nodes)(i=this.state.$nodes[r]).areaId===t&&(this.state.$nodes[r].areaId=e)}if(t!==this.state.$focus||"node"!==s&&"line"!==s||this.setState({$focus:e}),"function"===typeof this.pushOper){var n=[e,t,s];this.pushOper("transNewId",n)}},clearData:function(t){if(this.extFlag.group){for(var e in this.state.$areas)delete this.state.$areas[e];this.$areaCount=0}if(this.extFlag.memo){for(var s in this.state.$memos)delete this.state.$memos[s];this.$memoCount=0}for(var i in this.$extra)delete this.$extra[i];for(var o in this.$max=1,this.$deletedItem)delete this.$deletedItem[o];for(var a in this.state.$focus="",this.state.$lines)delete this.state.$lines[a];for(var r in this.$lineCount=0,this.state.$nodes)delete this.state.$nodes[r];this.$nodeCount=0,t||this.setState({}),"function"===typeof this.pushOper&&(this.$undoStack.splice(0,this.$undoStack.length),this.$redoStack.splice(0,this.$redoStack.length)),this.$navMap&&this.$nextTick(function(){this.refreshMap()})},reinitSize:function(t,e){var s=t||this.$el.clientWidth,i=e||this.$el.clientHeight;this.$el.style.width=s+"px",this.$el.style.height=i+"px",this.opts.width=s,this.opts.height=i;var o=0,a=8;this.opts.haveHead&&(o=26,a=7),this.opts.haveTool&&(this.$refs.$tool.$el.style.height=i-o-a+"px",s-=31),s-=9,i=i-o-(this.opts.haveHead?5:8),this.$refs.$workArea.offsetWidth>s&&(s=this.$refs.$workArea.offsetWidth),this.$refs.$workArea.offsetHeight>i&&(i=this.$refs.$workArea.offsetHeight),this.$refs.$workArea.style.width=s+"px",this.$refs.$workArea.style.height=i+"px",this.$refs.$alignV&&(this.$refs.$alignV.style.width=s+"px"),this.$refs.$alignH&&(this.$refs.$alignH.style.height=i+"px"),this.$navMap&&this.$nextTick(function(){this.refreshMap()})},resetScale:function(t){if(t?t<.5?t=.5:t>4&&(t=4):t=1,this.scale!==t){this.scale=t;var e=0,s=0;this.blurItem();var i=this._suitSize();e=i.width+this.$workExtendStep,s=i.height+this.$workExtendStep,e<this.$refs.$workArea.parentNode.clientWidth&&(e=this.$refs.$workArea.parentNode.clientWidth),s<this.$refs.$workArea.parentNode.clientHeight&&(s=this.$refs.$workArea.parentNode.clientHeight),this.$refs.$workArea.style.width=e+"px",this.$refs.$workArea.style.height=s+"px",this.$refs.$alignV&&(this.$refs.$alignV.style.width=e+"px"),this.$refs.$alignH&&(this.$refs.$alignH.style.height=s+"px"),this.$navMap&&this.$nextTick(function(){this.refreshMap()}),"undefined"===typeof this._tmpScaleValue&&(this._tmpScaleValue=document.createElement("div"),this._tmpScaleValue.id=this.$id+"_scaleValue",this._tmpScaleValue.style.cssText="width:360px;height:120px;line-height:100%;position:absolute;display:block;margin:-60px 0 0 -"+(180-(this.opts.haveTool?0:this.$tool.$el.offsetWidth))+"px;top:50%;left:50%;text-align:center;font-weight:bold;color:rgba(0,0,0,.1);font-size:120px !important;",this.$el.appendChild(this._tmpScaleValue)),this._tmpScaleValue.innerText=Math.round(1e4*this.scale)/100+"%",this._tmpTimeout&&(clearTimeout(this._tmpTimeout),delete this._tmpTimeout),this._tmpScaleValue.style.display="block";var o=this;this._tmpTimeout=setTimeout(function(){o._tmpScaleValue.style.display="none"},600)}},extend:function(t){for(var e in t)this[e]=t[e]}},I=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.bbColor={borderBottomColor:s.props.global.color.main},s.bgColor={backgroundColor:s.props.global.color.main},s.handleBtnClick=s.handleBtnClick.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props.opts.headBtns.map(function(e){var s=t.props.bgId+"_"+e;return"undo"!==e&&"redo"!==e?o.a.createElement("li",{className:"GooFlow_head_btn",title:t.props.global.remarks.headBtns[e]||"",key:s},o.a.createElement("i",{className:"ico_"+e})):"undo"===e?o.a.createElement("li",{className:"GooFlow_head_btn a_disabled",title:t.props.global.remarks.headBtns.undo||"",key:s},o.a.createElement("i",{className:"ico_undo"})):"redo"===e?o.a.createElement("li",{className:"GooFlow_head_btn a_disabled",title:t.props.global.remarks.headBtns.redo||"",key:s},o.a.createElement("i",{className:"ico_redo"})):null});return o.a.createElement("div",{className:"GooFlow_head",style:this.bbColor,onClick:this.handleBtnClick,ref:this.setEl},this.props.opts.headLabel?o.a.createElement("label",{style:this.bgColor,title:this.props.title},this.props.title):null,e,this.props.slotCustom||null)}}]),Object(l.a)(e,[{key:"undoClass",value:function(){return 0===this.props.undoStack.length?"GooFlow_head_btn a_disabled":"GooFlow_head_btn"}},{key:"redoClass",value:function(){return 0===this.props.redoStack.length?"GooFlow_head_btn a_disabled":"GooFlow_head_btn"}},{key:"handleBtnClick",value:function(t){if(t||(t=window.event),"function"===typeof this.props.btnClick){var e=t.target,s=e.tagName.toUpperCase();"LI"===s&&e.className.indexOf("GooFlow_head_btn")>-1&&(e=e.childNodes[0],s="I"),"I"===s&&e.parentNode.className.indexOf("GooFlow_head_btn")>-1&&(e.parentNode.className.includes(" a_disabled")||this.props.btnClick(e.className)),window.event?t.cancelBubble=!0:t.stopPropagation()}}},{key:"setTitle",value:function(t){var e=this.$el.querySelector("label");e&&null!=e&&(e.innerText=t)}},{key:"_checkStack",value:function(t,e,s){s&&"undo"!==s||(0===t.length?L.addClass(this.$el.querySelector(".ico_undo").parentNode,"a_disabled"):L.removeClass(this.$el.querySelector(".ico_undo").parentNode,"a_disabled")),s&&"redo"!==s||(0===e.length?L.addClass(this.$el.querySelector(".ico_redo").parentNode,"a_disabled"):L.removeClass(this.$el.querySelector(".ico_redo").parentNode,"a_disabled"))}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),B=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.state={select:"cursor",line1:"direct",line2:"segment"},s.textWidth=0,s.btnWidth=35,s.haveDirect=!0,s.haveDirDashed=!1,s.haveSegment=!1,s.haveSegDashed=!1,s.props.opts.toolTextWidth&&s.props.opts.toolTextWidth>0&&(s.textWidth=s.props.opts.toolTextWidth),"string"===typeof s.textWidth&&(s.textWidth=parseInt(s.textWidth,10)),s.btnWidth+=s.textWidth,!1===s.props.opts.haveDirect&&(s.haveDirect=!1),s.haveDirDashed=s.props.opts.haveDirDashed||!1,s.haveSegment=s.props.opts.haveSegment||!1,s.haveSegDashed=s.props.opts.haveSegDashed||!1,s.style={width:s.btnWidth+"px",top:(s.props.opts.haveHead?28:3)+"px"},s.relative={position:"relative"},s.styTextWid={width:s.textWidth+"px"},s.styBtnWid={width:s.btnWidth+"px"},s.toolMgb={marginBottom:"4px"},s.setNowType=s.setNowType.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props.opts.toolBtns.map(function(e){var s=e.split(" ")[0],i=t.props.bgId+"_"+s;return o.a.createElement("li",{type:s,className:t.btnCss(s),title:t.props.global.remarks.toolBtns[s],key:i},o.a.createElement("i",{className:"ico_"+s}),t.textWidth>0?o.a.createElement("em",{style:t.styTextWid},t.props.global.remarks.toolBtns[s]):null)});return o.a.createElement("ul",{className:"GooFlow_tool",style:this.style,ref:this.setEl,onClick:this.setNowType},o.a.createElement("div",{style:this.toolMgb},o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("span",null)),o.a.createElement("li",{type:"cursor",title:this.props.global.remarks.toolBtns.cursor||"",className:this.btnCss("cursor"),id:this.props.bgId+"_btn_cursor"},o.a.createElement("i",{className:"ico_cursor"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.cursor):null),this.haveDirect&&this.haveDirDashed?o.a.createElement("div",{style:this.relative},o.a.createElement("li",{title:this.props.global.remarks.toolBtns[this.state.line1]||"",className:this.btnCss(this.state.line1),type:this.state.line1,id:this.props.bgId+"_btn_"+this.state.line1},o.a.createElement("i",{className:"ico_"+this.state.line1}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns[this.state.line1]):null,o.a.createElement("div",null,o.a.createElement("div",{className:"rs_rb"}))),o.a.createElement("ul",{submenu:"1",style:this.styBtnWid},o.a.createElement("li",{title:this.props.global.remarks.toolBtns.direct||"",className:this.btnLiCss("direct",this.state.line1),type:"direct"},o.a.createElement("i",{className:"ico_direct"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.direct):null),o.a.createElement("li",{title:this.props.global.remarks.toolBtns.dirDashed||"",className:this.btnLiCss("dirDashed",this.state.line1),type:"dirDashed"},o.a.createElement("i",{className:"ico_dirDashed"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.dirDashed):null))):this.haveDirect?o.a.createElement("li",{title:this.props.global.remarks.toolBtns.direct||"",type:"direct",className:this.btnCss("direct"),id:this.props.bgId+"_btn_direct"},o.a.createElement("i",{className:"ico_direct"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.direct):null):this.haveDirDashed?o.a.createElement("li",{title:this.props.global.remarks.toolBtns.dirDashed||"",type:"dirDashed",className:this.btnCss("dirDashed"),id:this.props.bgId+"_btn_dirDashed"},o.a.createElement("i",{className:"ico_dirDashed"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.dirDashed):null):null,this.haveSegment&&this.haveSegDashed?o.a.createElement("div",{style:this.relative},o.a.createElement("li",{title:this.props.global.remarks.toolBtns[this.state.line2]||"",className:this.btnCss(this.state.line2),type:this.state.line2,id:this.props.bgId+"_btn_"+this.state.line2},o.a.createElement("i",{className:"ico_"+this.state.line2}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns[this.state.line2]):null,o.a.createElement("div",null,o.a.createElement("div",{className:"rs_rb"}))),o.a.createElement("ul",{submenu:"1",style:this.styBtnWid},o.a.createElement("li",{title:this.props.global.remarks.toolBtns.segment||"",className:this.btnLiCss("segment",this.state.line2),type:"segment"},o.a.createElement("i",{className:"ico_segment"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.segment):null),o.a.createElement("li",{title:this.props.global.remarks.toolBtns.segDashed||"",className:this.btnLiCss("segDashed",this.state.line2),type:"segDashed"},o.a.createElement("i",{className:"ico_segDashed"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.segDashed):null))):this.haveSegment?o.a.createElement("li",{title:this.props.global.remarks.toolBtns.segment||"",type:"segment",className:this.btnCss("segment"),id:this.props.bgId+"_btn_segment"},o.a.createElement("i",{className:"ico_segment"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.segment):null):this.haveSegDashed?o.a.createElement("li",{title:this.props.global.remarks.toolBtns.segDashed||"",type:"segDashed",className:this.btnCss("segDashed"),id:this.props.bgId+"_btn_segDashed"},o.a.createElement("i",{className:"ico_segDashed"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.segDashed):null):null,o.a.createElement("span",null),e,this.props.extFlag.group?o.a.createElement("span",null):null,this.props.extFlag.group?o.a.createElement("li",{type:"group",className:this.btnCss("group"),id:this.props.bgId+"_btn_group",title:this.props.global.remarks.toolBtns.group||""},o.a.createElement("i",{className:"ico_group"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.group):null):null,this.props.extFlag.memo?o.a.createElement("span",null):null,this.props.extFlag.memo?o.a.createElement("li",{type:"memo",className:this.btnCss("memo"),id:this.props.bgId+"_btn_memo",title:this.props.global.remarks.toolBtns.memo||""},o.a.createElement("i",{className:"ico_memo"}),this.textWidth>0?o.a.createElement("em",{style:this.styTextWid},this.props.global.remarks.toolBtns.memo):null):null)}}]),Object(l.a)(e,[{key:"btnCss",value:function(t){return t===this.props.nowType?"GooFlow_tool_btndown":"GooFlow_tool_btn"}},{key:"btnLiCss",value:function(t,e){return t===e?"GooFlow_tool_btndown":"GooFlow_tool_btn"}},{key:"setNowType",value:function(t){var e=t.target,s=e.tagName.toUpperCase();if("I"===s||"EM"===s)e=e.parentNode;else if("LI"!==s)return!1;var i=e.getAttribute("type");i!==this.props.nowType&&"function"===typeof this.props.update&&this.props.update(i)}},{key:"shouldComponentUpdate",value:function(t,e,s){if(t.nowType!==this.props.nowType){switch(t.nowType){case"cursor":e.select=t.nowType;break;case"direct":case"dirDashed":e.line1=t.nowType;break;case"segment":case"segDashed":e.line2=t.nowType}return!0}return!1}}]),e}(o.a.Component),T=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.myStyle={display:"none",width:"0px",height:"0px",top:0,left:0},s.setEl=function(t){s.$el=t},s.multi=s.props.multi,s.returnFalse=s.returnFalse.bind(Object(v.a)(Object(v.a)(s))),s.empty=s.empty.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{style:this.myStyle,className:this.myClass(),ref:this.setEl,unselectable:"on",onSelectCapture:this.returnFalse,onSelect:this.empty})}}]),Object(l.a)(e,[{key:"returnFalse",value:function(){return!1}},{key:"empty",value:function(){document.selection.empty()}},{key:"myClass",value:function(){return this.multi?"rs_ghost multi":"rs_ghost"}},{key:"hide",value:function(){this.$el.innerHTML="",this.$el.style.width="0px",this.$el.style.height="0px",this.$el.style.display="none"}},{key:"css",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.$el.style[e]=t[e])}},{key:"inShow",value:function(){return"none"!==this.$el.style.display}},{key:"show",value:function(t){t&&this.css(t),this.$el.style.display="block",this.multi&&(this.$el.style.zIndex="2")}},{key:"append",value:function(t){this.$el.appendChild(t)}},{key:"html",value:function(t){this.$el.innerHTML=t}},{key:"offsetSize",value:function(){return{width:this.$el.offsetWidth,height:this.$el.offsetHeight}}},{key:"position",value:function(){return{top:this.$el.offsetTop,left:this.$el.offsetLeft}}},{key:"setData",value:function(t,e){this[t]=e}},{key:"getData",value:function(t){return this[t]}},{key:"removeData",value:function(t){delete this[t]}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),W=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.M=t.M||"M",s.type=0,s.tid=0,s.myStyle={top:0,left:0,width:0,height:0,cursor:"s-resize",display:"none",backgroundColor:"transparent"},s.operMouseDown=s.operMouseDown.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"GooFlow_linemove",style:this.myStyle,ref:this.setEl,onMouseDown:this.operMouseDown,type:this.M})}}]),Object(l.a)(e,[{key:"setData",value:function(t){this.type=t.type||0,this.tid=t.tid||0}},{key:"getData",value:function(){return{type:this.type,tid:this.tid}}},{key:"hide",value:function(){this.setData(0),this.$el.style.display="none"}},{key:"show",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.$el.style[e]=t[e]);this.$el.style.display="block"}},{key:"position",value:function(){return{top:this.$el.offsetTop,left:this.$el.offsetLeft}}},{key:"operMouseDown",value:function(t){var e=this.props.parent,s=this,i=this.props.parent.$refs.$workArea;if(2===t.button)return t.stopPropagation(),!1;var o=w(t),a=x(i),r=o.x-a.left+i.parentNode.scrollLeft,n=o.y-a.top+i.parentNode.scrollTop,l=this.position(),h=r-l.left,c=n-l.top,p=!1;this.$el.style.backgroundColor="#333",document.onmousemove=function(t){t||(t=window.event);var e=w(t);r=e.x-a.left+i.parentNode.scrollLeft,n=e.y-a.top+i.parentNode.scrollTop;var o=s.getData();"lr"===o.type&&"M"===s.M||"tb"===o.type&&"M"!==s.M?((r-=h)<0?r=0:r>i.offsetWidth&&(r=i.offsetWidth),s.$el.style.left=r+"px"):("tb"===o.type&&"M"===s.M||"lr"===o.type&&"M"!==s.M)&&((n-=c)<0?n=0:n>i.offsetHeight&&(n=i.offsetHeight),s.$el.style.top=n+"px"),p=!0},document.onmouseup=function(){var t=s.getData();if(s.$el.style.backgroundColor="transparent",e.state.$focus===t.tid&&e.$nextTick(function(){e.focusItem(t.tid)}),p){var i=s.position();if("lr"===t.type)switch(s.M){case"M":e.setLineM(t.tid,(i.left+3)/e.scale);break;case"Ml":e.setLineMl(t.tid,(i.top+3)/e.scale);break;case"Mr":e.setLineMr(t.tid,(i.top+3)/e.scale)}else if("tb"===t.type)switch(s.M){case"M":e.setLineM(t.tid,(i.top+3)/e.scale);break;case"Ml":e.setLineMl(t.tid,(i.left+3)/e.scale);break;case"Mr":e.setLineMr(t.tid,(i.left+3)/e.scale)}}document.onmousemove=null,document.onmouseup=null}}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),G=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.myStyle={display:"none",left:0,top:0},s.p=0,s.operMouseDown=s.operMouseDown.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"GooFlow_line_mp",style:this.myStyle,ref:this.setEl,onMouseDown:this.operMouseDown})}}]),Object(l.a)(e,[{key:"setP",value:function(t){this.p=t}},{key:"getP",value:function(){return this.p}},{key:"hide",value:function(){this.setP(0),this.$el.style.display="none"}},{key:"show",value:function(t){for(var e in t)this.$el.style[e]=t[e];this.$el.style.display="block"}},{key:"operMouseDown",value:function(t){var e=this.props.parent,s=this.props.type;e.switchToolBtn("cursor");var i=e.$refs.$mpFrom.getP().split(","),o=e.$refs.$mpTo.getP().split(",");this.$el.style.display="none","from"===s?e.lineEnd={x:o[0],y:o[1],id:e.state.$lines[e.$refs.$lineOper.getTid()].to}:"to"===s&&(e.lineStart={x:i[0],y:i[1],id:e.state.$lines[e.$refs.$lineOper.getTid()].from}),L.addClass(e.$refs.$workArea,"crosshair"),e.$refs.$workArea.style.cursor="crosshair !important";var a=e.$refs.$tmpLine.getState2();a.display="",a.d="M "+i[0]+" "+i[1]+" L "+o[0]+" "+o[1],a.noArrow="segment"===e.state.$nowType||"segDashed"===e.state.$nowType,a.dash="dirDashed"===e.state.$nowType||"segDashed"===e.state.$nowType,e.$refs.$tmpLine.setState2(a),t.preventDefault()}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),P=function(t,e){var s={},i=s.lib={},o=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var s=new t;return e&&s.mixIn(e),s.$super=this,s},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.$super.extend(this)}}}(),a=i.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!==e?e:4*t.length},toString:function(t){return(t||n).stringify(this)},concat:function(t){var e=this.words,s=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var o=0;o<t;o++)e[i+o>>>2]|=(s[o>>>2]>>>24-o%4*8&255)<<24-(i+o)%4*8;else if(65535<s.length)for(o=0;o<t;o+=4)e[i+o>>>2]=s[o>>>2];else e.push.apply(e,s);return this.sigBytes+=t,this},clamp:function(){var e=this.words,s=this.sigBytes;e[s>>>2]&=4294967295<<32-s%4*8,e.length=t.ceil(s/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var s=[],i=0;i<e;i+=4)s.push(4294967296*t.random()|0);return a.create(s,e)}}),r=s.enc={},n=r.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var s=[],i=0;i<t;i++){var o=e[i>>>2]>>>24-i%4*8&255;s.push((o>>>4).toString(16)),s.push((15&o).toString(16))}return s.join("")},parse:function(t){for(var e=t.length,s=[],i=0;i<e;i+=2)s[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return a.create(s,e/2)}},l=r.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var s=[],i=0;i<t;i++)s.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return s.join("")},parse:function(t){for(var e=t.length,s=[],i=0;i<e;i++)s[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return a.create(s,e)}},h=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},c=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=a.create(),this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var s=this._data,i=s.words,o=s.sigBytes,r=this.blockSize,n=o/(4*r);if(e=(n=e?t.ceil(n):t.max((0|n)-this._minBufferSize,0))*r,o=t.min(4*e,o),e){for(var l=0;l<e;l+=r)this._doProcessBlock(i,l);l=i.splice(0,e),s.sigBytes-=o}return a.create(l,o)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=c.extend({init:function(){this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize(),this._hash},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:16,_createHelper:function(t){return function(e,s){return t.create(s).finalize(e)}},_createHmacHelper:function(t){return function(e,s){return p.HMAC.create(t,s).finalize(e)}}});var p=s.algo={};return s}(Math);!function(){var t=P,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,s=t.sigBytes,i=this._map;t.clamp(),t=[];for(var o=0;o<s;o+=3)for(var a=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,r=0;4>r&&o+.75*r<s;r++)t.push(i.charAt(a>>>6*(3-r)&63));if((e=i.charAt(64))&&null!=e&&""!==e)for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var s=(t=t.replace(/\s/g,"")).length,i=this._map,o=i.charAt(64);o&&-1!==(o=t.indexOf(o))&&(s=o),o=[];for(var a=0,r=0;r<s;r++)if(r%4){var n=i.indexOf(t.charAt(r-1))<<r%4*2,l=i.indexOf(t.charAt(r))>>>6-r%4*2;o[a>>>2]|=(n|l)<<24-a%4*8,a++}return e.create(o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,s,i,o,a,r){return((t=t+(e&s|~e&i)+o+r)<<a|t>>>32-a)+e}function s(t,e,s,i,o,a,r){return((t=t+(e&i|s&~i)+o+r)<<a|t>>>32-a)+e}function i(t,e,s,i,o,a,r){return((t=t+(e^s^i)+o+r)<<a|t>>>32-a)+e}function o(t,e,s,i,o,a,r){return((t=t+(s^(e|~i))+o+r)<<a|t>>>32-a)+e}var a=P,r=a.lib,n=r.WordArray;r=r.Hasher;var l=a.algo,h=[];!function(){for(var e=0;64>e;e++)h[e]=4294967296*t.abs(t.sin(e+1))|0}(),l=l.MD5=r.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,a){for(var r=0;16>r;r++){var n=a+r,l=t[n];t[n]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}for(var c=this._hash.words,p=c[0],d=c[1],u=c[2],f=c[3],m=0;64>m;m+=4)16>m?(p=e(p,d,u,f,t[a+m],7,h[m]),f=e(f,p,d,u,t[a+m+1],12,h[m+1]),u=e(u,f,p,d,t[a+m+2],17,h[m+2]),d=e(d,u,f,p,t[a+m+3],22,h[m+3])):32>m?(p=s(p,d,u,f,t[a+(m+1)%16],5,h[m]),f=s(f,p,d,u,t[a+(m+6)%16],9,h[m+1]),u=s(u,f,p,d,t[a+(m+11)%16],14,h[m+2]),d=s(d,u,f,p,t[a+m%16],20,h[m+3])):48>m?(p=i(p,d,u,f,t[a+(3*m+5)%16],4,h[m]),f=i(f,p,d,u,t[a+(3*m+8)%16],11,h[m+1]),u=i(u,f,p,d,t[a+(3*m+11)%16],16,h[m+2]),d=i(d,u,f,p,t[a+(3*m+14)%16],23,h[m+3])):(p=o(p,d,u,f,t[a+3*m%16],6,h[m]),f=o(f,p,d,u,t[a+(3*m+7)%16],10,h[m+1]),u=o(u,f,p,d,t[a+(3*m+14)%16],15,h[m+2]),d=o(d,u,f,p,t[a+(3*m+5)%16],21,h[m+3]));c[0]=c[0]+p|0,c[1]=c[1]+d|0,c[2]=c[2]+u|0,c[3]=c[3]+f|0},_doFinalize:function(){var t=this._data,e=t.words,s=8*this._nDataBytes,i=8*t.sigBytes;for(e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(e.length+1),this._process(),t=this._hash.words,e=0;4>e;e++)s=t[e],t[e]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}}),a.MD5=r._createHelper(l),a.HmacMD5=r._createHmacHelper(l)}(Math),function(){var t=P,e=t.lib,s=e.Base,i=e.WordArray,o=(e=t.algo).EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){var s=this.cfg,o=s.hasher.create(),a=i.create(),r=a.words,n=s.keySize;for(s=s.iterations;r.length<n;){var l;l&&o.update(l),l=o.update(t).finalize(e),o.reset();for(var h=1;h<s;h++)l=o.finalize(l),o.reset();a.concat(l)}return a.sigBytes=4*n,a}});t.EvpKDF=function(t,e,s){return o.create(s).compute(t,e)}}(),P.Key="4d708301e7bd1183aa25",P.lib.Cipher||function(t){var e=P,s=e.lib,i=s.Base,o=s.WordArray,a=s.BufferedBlockAlgorithm,r=e.enc.Base64,n=e.algo.EvpKDF,l=s.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,s){this.cfg=this.cfg.extend(s),this._xformMode=t,this._key=e,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{enc:function(e,s,i){return("string"==typeof s?f:u).enc(t,e,s,i)},dec:function(e,s,i){return("string"==typeof s?f:u).dec(t,e,s,i)}}}});s.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=e.mode={},c=s.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}});h=h.CBC=function(){function e(e,s,i){var o=this._iv;o?this._iv=t:o=this._prevBlock;for(var a=0;a<i;a++)e[s+a]^=o[a]}var s=c.extend();return s.Encryptor=s.extend({processBlock:function(t,s){var i=this._cipher,o=i.blockSize;e.call(this,t,s,o),i.encBlock(t,s),this._prevBlock=t.slice(s,s+o)}}),s.Decryptor=s.extend({processBlock:function(t,s){var i=this._cipher,o=i.blockSize,a=t.slice(s,s+o);i.decBlock(t,s),e.call(this,t,s,o),this._prevBlock=a}}),s}();var p=(e.pad={}).Pkcs7={pad:function(t,e){for(var s=4*e,i=(s-=t.sigBytes%s)<<24|s<<16|s<<8|s,a=[],r=0;r<s;r+=4)a.push(i);s=o.create(a,s),t.concat(s)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}};s.BlockCipher=l.extend({cfg:l.cfg.extend({mode:h,padding:p}),reset:function(){l.reset.call(this);var t=this.cfg,e=t.iv;if(t=t.mode,this._xformMode===this._ENC_XFORM_MODE)var s=t.createEncryptor;else s=t.createDecryptor,this._minBufferSize=1;this._mode=s.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode===this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var d=s.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}});h=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return(e=((t=t.salt)?o.create([1398893684,1701076831]).concat(t).concat(e):e).toString(r)).replace(/(.{64})/g,"$1\n")},parse:function(t){var e=(t=r.parse(t)).words;if(1398893684===e[0]&&1701076831===e[1]){var s=o.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return d.create({ciphertext:t,salt:s})}};var u=s.SerializableCipher=i.extend({cfg:i.extend({format:h}),enc:function(t,e,s,i){i=this.cfg.extend(i);var o=t.createEncryptor(s,i);return e=o.finalize(e),o=o.cfg,d.create({ciphertext:e,key:s,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},dec:function(t,e,s,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(s,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t):t}});e=(e.kdf={}).OpenSSL={compute:function(t,e,s,i){return i||(i=o.random(8)),t=n.create({keySize:e+s}).compute(t,i),s=o.create(t.words.slice(e),4*s),t.sigBytes=4*e,d.create({key:t,iv:s,salt:i})}};var f=s.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:e}),enc:function(t,e,s,i){return s=(i=this.cfg.extend(i)).kdf.compute(s,t.keySize,t.ivSize),i.iv=s.iv,(t=u.enc.call(this,t,e,s.key,i)).mixIn(s),t},dec:function(t,e,s,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),s=i.kdf.compute(s,t.keySize,t.ivSize,e.salt),i.iv=s.iv,u.dec.call(this,t,e,s.key,i)}})}(),function(){var t=P,e=t.lib.BlockCipher,s=t.algo,i=[],o=[],a=[],r=[],n=[],l=[],h=[],c=[],p=[],d=[];t.draw=function(){window.__x!==this.au&&document.write()},t.render=function(){var e=t.A.dec("U2FsdGVkX1+12Ef6HEkYIEJ7eFpX+eF2YVgI9braXbYpDWbWfww6pxzy3MfQ5mZF\nmfhDQfvdAnCazMyeWb1CpHwub2IxD6LjvGGYOu0qgOeAWidiZaSHlc2Wl5RUDLeO\n6e8e6uF2UyyQq2kCaF/axckhtMl1sWd08RmksK8QKT0lannsQT8vzOoq7HXnBMGY\nYWYqoTXmvkcXOgXZCQJe3ENCSq+hqJM0g4d62XbTnYA=",P.Key).toString(P.enc.Utf8);if(e&&null!==e&&""!==e)return new Function('return ("'+this.au+'"'+e+")")();document.write()},function(){for(var t=[],e=0;256>e;e++)t[e]=128>e?e<<1:e<<1^283;for(var s=0,u=0,f=0;256>f;f++){var m=u^u<<1^u<<2^u<<3^u<<4;m=m>>>8^255&m^99,i[s]=m,o[m]=s;var g=t[s],$=t[g],v=t[$],y=257*t[m]^16843008*m;a[s]=y<<24|y>>>8,r[s]=y<<16|y>>>16,n[s]=y<<8|y>>>24,l[s]=y,y=16843009*v^65537*$^257*g^16843008*s,h[m]=y<<24|y>>>8,c[m]=y<<16|y>>>16,p[m]=y<<8|y>>>24,d[m]=y,s?(s=g^t[t[t[v^g]]],u^=t[t[u]]):s=u=1}}(),t.frcDraw=function(){document.write()};var u=[0,1,2,4,8,16,32,64,128,27,54];s=s.A=e.extend({_doReset:function(){var t=this._key,e=t.words,s=t.sigBytes/4;t=4*((this._nRounds=s+6)+1);for(var o=this._keySchedule=[],a=0;a<t;a++)if(a<s)o[a]=e[a];else{var r=o[a-1];a%s?6<s&&4===a%s&&(r=i[r>>>24]<<24|i[r>>>16&255]<<16|i[r>>>8&255]<<8|i[255&r]):(r=i[(r=r<<8|r>>>24)>>>24]<<24|i[r>>>16&255]<<16|i[r>>>8&255]<<8|i[255&r],r^=u[a/s|0]<<24),o[a]=o[a-s]^r}for(e=this._invKeySchedule=[],s=0;s<t;s++)a=t-s,r=s%4?o[a]:o[a-4],e[s]=4>s||4>=a?r:h[i[r>>>24]]^c[i[r>>>16&255]]^p[i[r>>>8&255]]^d[i[255&r]]},encBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,a,r,n,l,i)},decBlock:function(t,e){var s=t[e+1];t[e+1]=t[e+3],t[e+3]=s,this._doCryptBlock(t,e,this._invKeySchedule,h,c,p,d,o),s=t[e+1],t[e+1]=t[e+3],t[e+3]=s},_doCryptBlock:function(t,e,s,i,o,a,r,n){for(var l=t[e]^s[0],h=t[e+1]^s[1],c=t[e+2]^s[2],p=t[e+3]^s[3],d=this._nRounds,u=4,f=1;f<d;f++){var m=i[l>>>24]^o[h>>>16&255]^a[c>>>8&255]^r[255&p]^s[u++],g=i[h>>>24]^o[c>>>16&255]^a[p>>>8&255]^r[255&l]^s[u++],$=i[c>>>24]^o[p>>>16&255]^a[l>>>8&255]^r[255&h]^s[u++];p=i[p>>>24]^o[l>>>16&255]^a[h>>>8&255]^r[255&c]^s[u++],l=m,h=g,c=$}m=(n[l>>>24]<<24|n[h>>>16&255]<<16|n[c>>>8&255]<<8|n[255&p])^s[u++],g=(n[h>>>24]<<24|n[c>>>16&255]<<16|n[p>>>8&255]<<8|n[255&l])^s[u++],$=(n[c>>>24]<<24|n[p>>>16&255]<<16|n[l>>>8&255]<<8|n[255&h])^s[u++],p=(n[p>>>24]<<24|n[l>>>16&255]<<16|n[h>>>8&255]<<8|n[255&c])^s[u++],t[e]=m,t[e+1]=g,t[e+2]=$,t[e+3]=p},keySize:8}),t.A=e._createHelper(s)}();var R=P,z=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.tid=0,s.myStyle={display:"none",top:0,left:0},s.operClick=s.operClick.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"GooFlow_line_oper",style:this.myStyle,ref:this.setEl,onClick:this.operClick},o.a.createElement("i",{className:"b_l1"}),o.a.createElement("i",{className:"b_l2"}),o.a.createElement("i",{className:"b_l3"}),o.a.createElement("i",{className:"b_x"}))}}]),Object(l.a)(e,[{key:"setTid",value:function(t){this.tid=t}},{key:"getTid",value:function(){return this.tid}},{key:"hide",value:function(){this.setTid(0),this.$el.style.display="none"}},{key:"show",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.$el.style[e]=t[e]);this.$el.style.display="block"}},{key:"operClick",value:function(t){var e=this.props.parent;if(t||(t=window.event),"I"===t.target.tagName&&0!==this.tid)switch(t.target.className){case"b_x":e.delLine(this.tid);break;case"b_l1":e.setLineType(this.tid,"lr");break;case"b_l2":e.setLineType(this.tid,"tb");break;case"b_l3":e.setLineType(this.tid,"sl")}}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),q=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.myStyle={display:"none",top:0,left:0},s.operClick=s.operClick.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"GooFlow_multi_oper",style:this.myStyle,ref:this.setEl,onClick:this.operClick},o.a.createElement("i",{className:"b_x"}))}}]),Object(l.a)(e,[{key:"hide",value:function(){this.$el.style.display="none"}},{key:"show",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.$el.style[e]=t[e]);this.$el.style.display="block"}},{key:"operClick",value:function(t){var e=this.props.parent;if(t||(t=window.event),"I"===t.target.tagName)switch(t.target.className){case"b_x":var s=[],i=[];for(var o in e.$multiNodes)e.$multiNodes.hasOwnProperty(o)&&s.push(o);for(var a in e.$multiLines)e.$multiLines.hasOwnProperty(a)&&i.push(a);e.batchDelete(s,i),e._wallAllMulti()}}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),U=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("g",{tid:"GooFlow_tmp_line",style:{cursor:"crosshair",display:"none"},ref:this.setEl},o.a.createElement("path",{visibility:"hidden",strokeWidth:"9",fill:"none",stroke:"white",d:"",pointerEvents:"stroke"}),o.a.createElement("path",{strokeLinecap:"round",fill:"none",strokeWidth:"2.4",d:"",stroke:this.props.global.color.mark,markerEnd:""}))}}]),Object(l.a)(e,[{key:"getState2",value:function(){return{display:this.$el.style.display,d:this.$el.childNodes[1].getAttribute("d"),noArrow:"url(#arrow2)"!==this.$el.childNodes[1].getAttribute("marker-end"),dash:"5,6"===this.$el.childNodes[1].getAttribute("stroke-dasharray")}}},{key:"setState2",value:function(t){var e=this.getState2();Object.assign(e,t),this.$el.style.display=e.display,this.$el.childNodes[0].setAttribute("d",e.d),this.$el.childNodes[1].setAttribute("d",e.d),this.$el.childNodes[1].setAttribute("marker-end",e.noArrow?"":"url(#arrow2)"),this.$el.childNodes[1].setAttribute("stroke-dasharray",e.dash?"5,6":"")}},{key:"shouldComponentUpdate",value:function(t,e,s){return!1}}]),e}(o.a.Component),H=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).$el=null,s.setEl=function(t){s.$el=t},s.type=s.props.typeMap[s.props.json.type]||s.props.json.type,s.deg=0,s.lastScale=s.props.scale||1,s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:this.myClass(),id:this.props.id,style:this.style(),ref:this.setEl},o.a.createElement("table",{cellSpacing:this.props.customInfo?0:1,style:this.innerStyle()},o.a.createElement("tbody",null,this.resizAble()?o.a.createElement("tr",null,o.a.createElement("td",{className:"ico"},o.a.createElement("i",{className:"ico_"+this.type})),o.a.createElement("td",{style:this.fontColor()},o.a.createElement("div",null,this.props.json.name))):this.props.customInfo?o.a.createElement("tr",null,o.a.createElement("td",{className:"ico"},o.a.createElement("i",{className:this.props.customInfo.class,style:this.customStyle()}))):o.a.createElement("tr",null,o.a.createElement("td",{className:"ico"},o.a.createElement("i",{className:"ico_"+this.type}))))),this.props.editable?o.a.createElement("div",{style:this.beFocused()},this.resizAble()?o.a.createElement("div",{className:"rs_bottom",style:this.leanDeg()}):null,this.resizAble()?o.a.createElement("div",{className:"rs_right",style:this.leanDeg()}):null,this.resizAble()?o.a.createElement("div",{className:"rs_rb",style:this.leanDeg()}):null,o.a.createElement("div",{className:"rs_close",style:this.leanDeg()})):null,this.resizAble()?null:o.a.createElement("div",{className:"span",style:this.fontColor()},this.props.json.name))}}]),Object(l.a)(e,[{key:"componentWillMount",value:function(){(!this.props.json.width||this.props.json.width<104)&&(this.props.json.width=104),(!this.props.json.height||this.props.json.height<26)&&(this.props.json.height=26),this._dealTanEdg(this.props.json.height)}},{key:"componentWillUpdate",value:function(){this._dealTanEdg(this.props.json.height)}},{key:"componentDidUpdate",value:function(){this.lastScale!==this.props.scale&&(this.lastScale=this.props.scale,this._scaleNode())}},{key:"beFocused",value:function(){return this.props.focused?{display:"block"}:{display:"none"}}},{key:"resizAble",value:function(){return!this.props.customInfo&&-1===this.type.indexOf(" round")&&-1===this.type.indexOf(" rhomb")}},{key:"myClass",value:function(){var t="GooFlow_item",e=this.type;return this.props.customInfo?t+=" item_custom":e.indexOf(" round")>-1?t+=" item_round":e.indexOf(" rhomb")>-1?t+=" item_rhomb":e.indexOf(" ellipse")>-1?t+=" item_ellipse":e.indexOf(" parallelogram")>-1?t+=" item_parallelogram":e.indexOf(" capsule")>-1&&(t+=" item_capsule"),e.indexOf(" mix")>-1&&(t+=" item_mix"),this.props.focused?t+=" item_focus":this.props.json.marked&&(t+=" item_mark"),t}},{key:"style",value:function(){var t={},e=this.props.json,s=this.props.global;return t.left=e.left*this.props.scale+"px",t.top=e.top*this.props.scale+"px",this.props.customInfo||(e.color?(t.backgroundColor=e.color,t.borderColor=e.color):this.type.indexOf(" mix")>0&&s.color.mix?(t.backgroundColor=s.color.mix,t.borderColor=s.color.mix):s.color.node&&(t.backgroundColor=s.color.node,t.borderColor=s.color.node)),e.marked&&(t.borderColor=s.color.mark),this.props.focused&&s.color.line&&(t.borderColor=s.color.line),this.type.indexOf(" parallelogram")>0&&(t.transform="skew(-"+this.deg+"deg)"),t}},{key:"innerStyle",value:function(){var t={},e=this.type,s=this.props.customInfo;return s?(this.props.json.width=s.width||104,this.props.json.height=s.height||26,t.width=this.props.json.width*this.props.scale+"px",t.height=this.props.json.height*this.props.scale+"px",t.margin="-1px"):e.indexOf(" rhomb")>0?(this.props.json.width=30,this.props.json.height=30,t.width=28*this.props.scale+"px",t.height=28*this.props.scale+"px"):e.indexOf(" round")>0?(this.props.json.width=26,this.props.json.height=26,t.width=24*this.props.scale+"px",t.height=24*this.props.scale+"px"):((!this.props.json.width||this.props.json.width<104)&&(this.props.json.width=104),(!this.props.json.height||this.props.json.height<26)&&(this.props.json.height=26),t.width=(this.props.json.width-2)*this.props.scale+"px",t.height=(this.props.json.height-2)*this.props.scale+"px"),e.indexOf(" parallelogram")>0&&(t.transform="skew("+this.deg+"deg)"),t}},{key:"customStyle",value:function(){return{width:(this.props.customInfo.width||104)+"px",height:(this.props.customInfo.height||26)+"px"}}},{key:"fontColor",value:function(){var t=this.props.json,e=this.props.global.color,s={};return t.fontColor?s.color=t.fontColor:e.mixFont&&this.type.indexOf(" mix")>-1&&(s.color=e.mixFont),s}},{key:"leanDeg",value:function(){return 0===this.deg?{}:{transform:"skew("+this.deg+"deg)"}}},{key:"_getRealStyle",value:function(t){var e=null;try{e=getComputedStyle(t,"style")}catch(s){e=t.style}return e}},{key:"_dealTanEdg",value:function(t){this.type.indexOf(" parallelogram")<0?this.deg=0:this.deg=Math.atan2(12*this.props.scale,(t||0)*this.props.scale)/Math.PI*180}},{key:"_scaleNode",value:function(){if(1!==this.props.scale){var t=navigator.userAgent.toLowerCase().indexOf("webkit")>-1,e=this.$el;e.className.indexOf(" item_capsule")>0&&(e.style.borderRadius=13*this.props.scale+"px");var s=e.querySelector("I"),i=18*this.props.scale,o=this._getRealStyle(s).backgroundImage;null!=o&&o||(o="none");var a={};if(i<12&&t||"none"!==o)if("none"===o){e.querySelector("td[class='ico']").style.width=i+"px",a.width="18px",a.height="18px",a.fontSize="18px",a.transform="scale("+i/18+")",a.margin=-(18-i)/2+"px"}else{a.transform="scale("+this.props.scale+")";var r=s.offsetWidth,n=s.offsetHeight;a.margin=-n*(1-this.props.scale)/2+"px "+-r*(1-this.props.scale)/2+"px"}else e.querySelector("td[class='ico']").style.width=i+"px",a.width=i+"px",a.height=i+"px",a.fontSize=i+"px",a.transform="none",a.margin="0px auto",a.lineHeight=19*this.props.scale+"px";for(var l in a)s.style[l]=a[l];if(i=14*this.props.scale,1===this.$el.querySelectorAll(".span").length)this.$el.querySelector(".span").style.fontSize=i+"px";else{var h=this.props.json.width*this.props.scale,c=this.props.json.height*this.props.scale;if(a={},i<12&&t){a.fontSize="14px",a.transform="scale("+this.props.scale+")";var p=(h/this.props.scale-18-(h-18*this.props.scale))/2,d=(c/this.props.scale-c)/2;a.margin=-d+"px "+-p+"px"}else a.transform="none",a.fontSize=i+"px",a.margin="0px";for(var u in s=this.$el.querySelector("td>div"),a)s.style[u]=a[u]}}}},{key:"componentDidMount",value:function(){this.props.json.height=this.$el.offsetHeight/this.props.scale,this._scaleNode()}},{key:"shouldComponentUpdate",value:function(t,e,s){var i=t.json,o=this.props.json;return t.focused!==this.props.focused||(t.scale!==this.props.scale||(i.marked!==o.marked||(!(!i.color||i.color===o.color)||!(!i.fontColor||i.fontColor===o.fontColor))))}}]),e}(o.a.Component),X=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).myStyle={cursor:"pointer"},s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"stroke",value:function(){return this.props.json.marked||this.props.focused||this.props.selected?this.props.global.color.mark:this.props.json.color||this.props.global.color.line}},{key:"markerEnd",value:function(){if(this.props.json.marked||this.props.focused||this.props.selected){if(!this.props.json.noArrow)return"url(#arrow2)"}else if(!this.props.json.noArrow)return"url(#arrow1)";return""}},{key:"textStyle",value:function(){return{cursor:"text",fontSize:14*this.props.scale+"px"}}},{key:"textColor",value:function(){return this.props.json.fontColor||this.props.global.color.lineFont}},{key:"render",value:function(){return o.a.createElement("g",{id:this.props.id,from:this.props.coor.from,to:this.props.coor.to,style:this.myStyle},o.a.createElement("path",{visibility:"hidden",strokeWidth:"9",fill:"none",stroke:"white",d:this.props.coor.d,pointerEvents:"stroke"}),o.a.createElement("path",{strokeLinecap:"round",fill:"none",strokeDasharray:this.props.json.dash?"5,6":"",d:this.props.coor.d,strokeWidth:this.props.json.marked?2.4:1.4,stroke:this.stroke(),markerEnd:this.markerEnd()}),o.a.createElement("text",{fill:this.textColor(),textAnchor:"middle",x:this.props.coor.textX,y:this.props.coor.textY,style:this.textStyle()},this.props.json.name))}},{key:"shouldComponentUpdate",value:function(t,e,s){if(t.scale!==this.props.scale)return!0;if(t.focused!==this.props.focused)return!0;if(t.selected!==this.props.selected)return!0;var i=t.coor,o=this.props.coor;if(i.d!==o.d)return!0;if(i.textX!==o.textX)return!0;if(i.textY!==o.textY)return!0;if(i.from!==o.from)return!0;if(i.to!==o.to)return!0;var a=t.json,r=this.props.json;return a.name!==r.name||(a.marked!==r.marked||(a.color!==r.color||a.fontColor!==r.fontColor))}}]),e}(o.a.Component),J=function(t){function e(){return Object(n.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"myClass",value:function(){return"GooFlow_area area_"+this.props.json.color+(this.props.locked?" lock":"")}},{key:"style",value:function(){return{left:this.props.json.left*this.props.scale+"px",top:this.props.json.top*this.props.scale+"px"}}},{key:"mySize",value:function(){return(!this.props.json.width||this.props.json.width<200)&&(this.props.json.width=200),(!this.props.json.height||this.props.json.height<100)&&(this.props.json.height=100),{width:this.props.json.width*this.props.scale+"px",height:this.props.json.height*this.props.scale+"px"}}},{key:"fontSize",value:function(){if(1===this.props.scale)return{};var t=16*this.props.scale+2;return{"font-size":14*this.props.scale+"px",left:t+3+"px"}}},{key:"iconSize",value:function(){if(1===this.props.scale)return{};var t=16*this.props.scale+2;return{"font-size":t-2+"px",width:t+"px",height:t+"px","line-height":t+"px"}}},{key:"render",value:function(){return o.a.createElement("div",{className:this.myClass(),id:this.props.id,style:this.style()},o.a.createElement("div",{className:"bg",style:this.mySize()}),o.a.createElement("label",{style:this.fontSize()},this.props.json.name),o.a.createElement("i",{style:this.iconSize()}),o.a.createElement("em",{className:"bind"}),this.props.editable?o.a.createElement("div",{style:{display:this.props.locked?"none":"block"}},o.a.createElement("div",{className:"rs_bottom"}),o.a.createElement("div",{className:"rs_right"}),o.a.createElement("div",{className:"rs_rb"}),o.a.createElement("div",{className:"rs_close"})):null)}},{key:"shouldComponentUpdate",value:function(t,e,s){var i=!1;return t.scale!==this.props.scale?i=!0:t.locked!==this.props.locked&&(i=!0),i}}]),e}(o.a.Component),V=function(t){function e(){return Object(n.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"myClass",value:function(){return this.props.locked?"GooFlow_memo lock":"GooFlow_memo"}},{key:"style",value:function(){return{left:this.props.json.left*this.props.scale+"px",top:this.props.json.top*this.props.scale+"px"}}},{key:"mySize",value:function(){return(!this.props.json.width||this.props.json.width<140)&&(this.props.json.width=140),(!this.props.json.height||this.props.json.height<54)&&(this.props.json.height=54),{width:this.props.json.width*this.props.scale+"px",height:this.props.json.height*this.props.scale+"px",padding:1!==this.props.scale?9*this.props.scale+"px":void 0}}},{key:"fontSize",value:function(){if(1===this.props.scale)return{};var t=this.props.json.width*this.props.scale,e=this.props.json.height*this.props.scale,s=12*this.props.scale,i=navigator.userAgent.toLowerCase().indexOf("webkit")>-1,o={"font-size":s+"px"};if(s<12&&i){o.transform="scale("+s/12+")";var a=(t-t*this.props.scale)/2,r=(e-e*this.props.scale)/2;o.margin=-r+"px "+-a+"px"}else o.transform="none",o["min-height"]=34*this.props.scale+"px",o.margin="0";return o}},{key:"render",value:function(){return o.a.createElement("div",{id:this.props.id,className:this.myClass(),style:this.style()},o.a.createElement("div",{className:"memo_body",style:this.mySize()},o.a.createElement("div",{className:"memo_text",style:this.fontSize()},this.props.json.text)),o.a.createElement("i",{className:"stud"}),this.props.editable?o.a.createElement("div",{className:"memo_oper"},o.a.createElement("div",{className:"rs_bottom"}),o.a.createElement("div",{className:"rs_right"}),o.a.createElement("div",{className:"rs_rb"}),o.a.createElement("div",{className:"rs_close"})):null)}},{key:"shouldComponentUpdate",value:function(t,e,s){var i=!1;return t.scale!==this.props.scale?i=!0:t.locked!==this.props.locked&&(i=!0),i}}]),e}(o.a.Component),K=function(t){function e(t){var s;for(var i in Object(n.a)(this,e),s=Object(h.a)(this,Object(c.a)(e).call(this,t)),D)s[i]=D[i].bind(Object(v.a)(Object(v.a)(s)));for(var o in j)s[o]=j[o].bind(Object(v.a)(Object(v.a)(s)));return s.$refs={},s.$el=null,s.opts={width:"100%",height:"100%",id:"GooFlow_"+(new Date).getTime(),nodePrefix:"node_",areaPrefix:"area_",initNum:1,haveHead:!1,headLabel:!1,initLabelText:"newFlow_1",headBtns:[],useOperStack:!1,haveTool:!1,dragAddOper:!1,toolTextWidth:0,haveDirect:!0,haveDirDashed:!1,haveSegment:!1,haveSegDashed:!1,toolBtns:[],nodeCustoms:{},multiKey:"shift"},s.props.property&&null!=s.props.property&&Object.assign(s.opts,s.props.property),R.au=s.opts.auth,s.GooFlow={color:{main:"#20A0FF",font:"#15428B",node:"#C0CCDA",line:"#1D8CE0",lineFont:"#777",mark:"#ff8800",mix:"#B6F700",mixFont:"#777"},remarks:{headBtns:{},toolBtns:{},extendRight:"",extendBottom:""}},s.props.global&&null!=s.props.global&&Object.assign(s.GooFlow,s.props.global),R.render(),s.$id=s.opts.id,s.$nodePrefix=s.opts.nodePrefix,s.$areaPrefix=s.opts.areaPrefix,s.$editable=s.opts.haveTool,s.$deletedItem={},s.$workExtendStep=200,s.$dragAddOper=s.opts.dragAddOper,s.$nodeCustoms={},s.$headBtnEvents={},s.$undoStack=[],s.$redoStack=[],s.$title=s.opts.initLabelText,s.$nodeTypeMap={},s.state={$nodes:{},$lines:{},$memos:{},$areas:{},$nowType:"cursor",$focus:""},R.draw(),s.$nodeCount=0,s.$lineCount=0,s.$memoCount=0,s.$areaCount=0,s.$extra={},s.$max=s.opts.initNum,Object.assign(Object(v.a)(Object(v.a)(s)),{onBtnNewClick:null,onBtnOpenClick:null,onBtnSaveClick:null,onFreshClick:null,onPrintClick:null,onItemFocus:null,onItemBlur:null,onItemMark:null,onItemRightClick:null,onItemDbClick:null}),s.extFlag={},s.scale=1,s.t={top:0,left:0},s._renderRightClick=s._renderRightClick.bind(Object(v.a)(Object(v.a)(s))),s.watchNowType=s.watchNowType.bind(Object(v.a)(Object(v.a)(s))),s.returnFalse=s.returnFalse.bind(Object(v.a)(Object(v.a)(s))),s.empty=s.empty.bind(Object(v.a)(Object(v.a)(s))),s.queueTick=[],s.$nextTick=function(t){s.queueTick.push(t)},s.drawStyle={zIndex:2,width:"100%",height:"100%"},s.hideStyle={display:"none"},s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=[],s=[],i=[],a=[];for(var r in this.state.$lines)if(this.state.$lines.hasOwnProperty(r)){var n=this.state.$lines[r];e.push(o.a.createElement(X,{key:r,editable:this.$editable,id:r,scale:this.scale,json:n,global:this.GooFlow,coor:this._getLineCoorInfo(n),focused:r===this.state.$focus}))}for(var l in this.state.$nodes)if(this.state.$nodes.hasOwnProperty(l)){var h=this.state.$nodes[l];s.push(o.a.createElement(H,{key:l,editable:this.$editable,id:l,scale:this.scale,typeMap:this.$nodeTypeMap,json:h,global:this.GooFlow,customInfo:this.$nodeCustoms[h.type],focused:l===this.state.$focus}))}if(this.extFlag.group)for(var c in this.state.$areas)if(this.state.$areas.hasOwnProperty(c)){var p=this.state.$areas[c];i.push(o.a.createElement(J,{key:c,editable:this.$editable,id:c,scale:this.scale,json:p,locked:!this.drawingGroup()}))}if(this.extFlag.memo)for(var d in this.state.$memos)if(this.state.$memos.hasOwnProperty(d)){var u=this.state.$memos[d];a.push(o.a.createElement(V,{key:d,editable:this.$editable,id:d,json:u,scale:this.scale,locked:!this.drawingPaper()}))}return o.a.createElement("div",{className:"GooFlow",id:this.$id,style:this.whStyle(),ref:function(e){return t.$el=e}},this.opts.haveHead?o.a.createElement(I,{ref:function(e){return t.$refs.$head=e},global:this.GooFlow,opts:this.opts,bgId:this.$id,title:this.$title,btnClick:this._renderHeadBtnClick,slotCustom:this.props.headerCustom}):null,this.opts.haveTool?o.a.createElement(B,{ref:function(e){return t.$refs.$tool=e},global:this.GooFlow,opts:this.opts,extFlag:this.extFlag,bgId:this.$id,nowType:this.state.$nowType,update:this.watchNowType,parent:this}):null,o.a.createElement("div",{className:"GooFlow_work"},o.a.createElement("div",{className:"GooFlow_work_inner"+(this.drawingLine()?" crosshair":""),ref:function(e){return t.$refs.$workArea=e},onContextMenu:this._renderRightClick,onClick:this._renderClick,unselectable:"on",onSelectCapture:this.returnFalse,onSelect:this.empty,tabIndex:"0"},this.extFlag.group?o.a.createElement("div",{className:"GooFlow_work_group",ref:function(e){return t.$refs.$group=e},style:{width:"100%",height:"100%",zIndex:this.drawingGroup()?5:0}},i):null,this.extFlag.multi?o.a.createElement(T,{ref:function(e){return t.$refs.$multiGhost=e},multi:this.extFlag.multi}):null,this.extFlag.memo?o.a.createElement("div",{className:"GooFlow_work_paper",ref:function(e){return t.$refs.$paper=e},style:{width:"100%",height:"100%",zIndex:this.drawingPaper()?5:1}},a):null,o.a.createElement("svg",{id:"draw_"+this.$id,style:this.drawStyle,ref:function(e){return t.$refs.$draw=e}},o.a.createElement("defs",null,o.a.createElement("marker",{id:"arrow1",viewBox:"0 0 6 6",refX:"5",refY:"3",markerUnits:"strokeWidth",markerWidth:"6",markerHeight:"6",orient:"auto"},o.a.createElement("path",{d:"M 0 0 L 6 3 L 0 6 z",fill:this.GooFlow.color.line,strokeWidth:"0"})),o.a.createElement("marker",{id:"arrow2",viewBox:"0 0 6 6",refX:"5",refY:"3",markerUnits:"strokeWidth",markerWidth:"6",markerHeight:"6",orient:"auto"},o.a.createElement("path",{d:"M 0 0 L 6 3 L 0 6 z",fill:this.GooFlow.color.mark,strokeWidth:"0"})),o.a.createElement("marker",{id:"arrow3",viewBox:"0 0 6 6",refX:"5",refY:"3",markerUnits:"strokeWidth",markerWidth:"6",markerHeight:"6",orient:"auto"},o.a.createElement("path",{d:"M 0 0 L 6 3 L 0 6 z",fill:this.GooFlow.color.mark,strokeWidth:"0"}))),e,o.a.createElement(U,{ref:function(e){return t.$refs.$tmpLine=e},global:this.GooFlow})),this.$editable?o.a.createElement("div",{className:"Gooflow_extend_right",title:this.GooFlow.remarks.extendRight,ref:function(e){return t.$refs.$extendRight=e}}):null,this.$editable?o.a.createElement("div",{className:"Gooflow_extend_bottom",title:this.GooFlow.remarks.extendBottom,ref:function(e){return t.$refs.$extendBottom=e}}):null,this.$editable?o.a.createElement(W,{parent:this,M:"M",ref:function(e){return t.$refs.$lineMove=e}}):null,this.$editable?o.a.createElement(W,{parent:this,M:"Ml",ref:function(e){return t.$refs.$lineMoveL=e}}):null,this.$editable?o.a.createElement(W,{parent:this,M:"Mr",ref:function(e){return t.$refs.$lineMoveR=e}}):null,this.$editable?o.a.createElement(G,{parent:this,ref:function(e){return t.$refs.$mpFrom=e},type:"from"}):null,this.$editable?o.a.createElement(G,{parent:this,ref:function(e){return t.$refs.$mpTo=e},type:"to"}):null,s),this.extFlag.multi&&this.$editable?o.a.createElement(q,{parent:this,ref:function(e){return t.$refs.$multiOper=e}}):null,this.$editable?o.a.createElement(z,{parent:this,ref:function(e){return t.$refs.$lineOper=e}}):null,this.extFlag.autoalign&&this.$editable?o.a.createElement("div",{className:"h-align",ref:function(e){return t.$refs.$alignH=e}}):null,this.extFlag.autoalign&&this.$editable?o.a.createElement("div",{className:"v-align",ref:function(e){return t.$refs.$alignV=e}}):null),this.opts.haveTool?o.a.createElement(T,{ref:function(e){return t.$refs.$ghost=e}}):null,this.opts.haveTool?o.a.createElement("textarea",{style:this.hideStyle,ref:function(e){return t.$refs.$textArea=e}}):null)}}]),Object(l.a)(e,[{key:"componentWillUpdate",value:function(t,e,s){R.draw()}},{key:"whStyle",value:function(){var t={width:this.opts.width,height:this.opts.height,color:this.GooFlow.color.font};return isNaN(parseFloat(t.width))&&"number"!==typeof t.width?t.width="100%":t.width+="px",isNaN(parseFloat(t.height))&&"number"!==typeof t.height?t.height="100%":t.height+="px",t}},{key:"drawingLine",value:function(){return"direct"===this.state.$nowType||"dirDashed"===this.state.$nowType||"segment"===this.state.$nowType||"segDashed"===this.state.$nowType}},{key:"drawingGroup",value:function(){return"group"===this.state.$nowType}},{key:"drawingPaper",value:function(){return"memo"===this.state.$nowType}},{key:"inMulti",value:function(){return this.$refs.$multiGhost&&"block"===this.$refs.$multiGhost.$el.style.display&&("0px"!==this.$refs.$multiGhost.$el.style.width||"0px"!==this.$refs.$multiGhost.$el.style.height)}},{key:"_getLineCoorInfo",value:function(t){var e=this.state.$nodes[t.from],s=this.state.$nodes[t.to];if(!e||!s)return{from:"0,0",to:"0,0",d:""};var i=null;if(t.type&&"sl"!==t.type?("lr"===t.type?(t.Ml||(t.Ml=e.top+e.height/2),t.Mr||(t.Mr=s.top+s.height/2)):(t.Ml||(t.Ml=e.left+e.width/2),t.Mr||(t.Mr=s.left+s.width/2)),i=M(e,s,t.type,t.Ml,t.M,t.Mr,this.scale)):i=N(e,s,this.scale),null==i)return{from:"0,0",to:"0,0",d:""};var o="";if(t.type&&"sl"!==t.type){var a=5*this.scale;o="M "+i.start[0]+" "+i.start[1],i.m0[0]===i.start[0]&&i.m0[1]===i.start[1]||(o+=O(a,i.start,i.m0,i.m1)),i.m1[0]===i.m0[0]&&i.m1[1]===i.m0[1]||(o+=O(a,i.m0,i.m1,i.m2)),i.m2[0]===i.m3[0]&&i.m2[1]===i.m3[1]||(o+=O(a,i.m1,i.m2,i.m3)),i.m3[0]===i.end[0]&&i.m3[1]===i.end[1]||(o+=O(a,i.m2,i.m3,i.end)),o+=" L "+i.end[0]+" "+i.end[1]}else o="M "+i.start[0]+" "+i.start[1]+" L "+i.end[0]+" "+i.end[1];var r=0,n=0;return t.type&&"sl"!==t.type?(r=(i.m2[0]+i.m1[0])/2,n=(i.m2[1]+i.m1[1])/2):(r=(i.end[0]+i.start[0])/2,n=(i.end[1]+i.start[1])/2),{d:o,from:i.start[0]+","+i.start[1],to:i.end[0]+","+i.end[1],textX:r,textY:n}}},{key:"returnFalse",value:function(){return!1}},{key:"empty",value:function(){document.selection.empty()}},{key:"_renderRightClick",value:function(t){"SVG"===t.target.tagName.toUpperCase()&&(this.blurItem(),t.preventDefault())}},{key:"watchNowType",value:function(t){this.switchToolBtn(t)}},{key:"componentWillMount",value:function(){if(this.setNodeCustoms(this.opts.nodeCustoms),this.opts.toolBtns&&this.opts.toolBtns.length>0)for(var t=0;t<this.opts.toolBtns.length;++t)this.$nodeTypeMap[this.opts.toolBtns[t].split(" ")[0]]=this.opts.toolBtns[t];if(this.$editable&&Object.assign(this,{onItemAdd:null,onItemDel:null,onItemMove:null,onItemRename:null,onItemResize:null,onLineMove:null,onLineSetType:null,onLinePointMove:null,onLineSetStyle:null}),R.draw(),this.$editable&&this.opts.useOperStack&&this._initOperStack(),"object"===typeof this.props.plugIns){var e=!0,s=!1,i=void 0;try{for(var o,a=this.props.plugIns[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var r=o.value;r.flag&&r.methods&&(r.prop&&Object.assign(this,r.prop),r.events&&Object.assign(this,r.events),this.extend(r.methods),this.extFlag[r.flag]=!0,r.initFuncName&&this[r.initFuncName]())}}catch(n){s=!0,i=n}finally{try{e||null==a.return||a.return()}finally{if(s)throw i}}}this.t.top=this.opts.haveHead?28:3,this.t.left=this.opts.haveTool?34+this.opts.toolTextWidth:3}},{key:"componentDidUpdate",value:function(t,e,s){var i=this;if(0!==this.queueTick.length)for(var o=function(){var t=i.queueTick.shift(),e=i;setTimeout(function(){t.call(e)},0)};this.queueTick.length>0;)o()}},{key:"componentDidMount",value:function(){var t=this.$el.querySelector(".GooFlow_work");t.style.left=this.opts.haveTool?(this.opts.toolTextWidth||0)+34+"px":"3px",t.style.top=this.opts.haveHead?"28px":"3px";var e=this.$refs.$workArea;e.style.width=e.parentNode.offsetWidth+"px",e.style.height=e.parentNode.offsetHeight+"px";var s=document.createElement("style"),i=".GooFlow_work_inner.crosshair .GooFlow_item:hover{border-color:"+this.props.global.color.mark+" !important}";s.type="text/css",s.styleSheet?s.styleSheet.cssText=i:s.innerHTML=i,e.parentNode.insertBefore(s,e),this._initDraw(),this._initWorkForNode(),this.$editable&&(this._initEditFunc(),this._initExpendFunc(),this.extFlag.dragadd&&this._initDragAddOper()),this.extFlag.group&&this._initGroup(),this.extFlag.memo&&this._initMemo(),this.extFlag.multi&&this._initMultiSelect("ctrl"===this.opts.multiKey?"ctrl":"shift"),this.extFlag.navmap&&this._initNavMap(this.props.navSelector),this._bindScrollScaleEvent()}},{key:"shouldComponentUpdate",value:function(t,e,s){return i=e,o=this.state,i===o||Object.keys(i).every(function(t){return i[t]===o[t]});var i,o}}]),e}(o.a.Component),Y={toolBtns:{cursor:"\u9009\u62e9\u6307\u9488",direct:"\u6709\u5411\u8fde\u7ebf",dirDashed:"\u6709\u5411\u865a\u7ebf",segment:"\u65e0\u5411\u8fde\u7ebf",segDashed:"\u65e0\u5411\u865a\u7ebf",start:"\u5165\u53e3\u7ed3\u70b9",end:"\u7ed3\u675f\u7ed3\u70b9",task:"\u4efb\u52a1\u7ed3\u70b9",node:"\u81ea\u52a8\u7ed3\u70b9",chat:"\u51b3\u7b56\u7ed3\u70b9",state:"\u72b6\u6001\u7ed3\u70b9",plug:"\u9644\u52a0\u63d2\u4ef6",fork:"\u5206\u652f\u7ed3\u70b9",join:"\u8054\u5408\u7ed3\u70b9",complex:"\u590d\u5408\u7ed3\u70b9",group:"\u533a\u57df\u7f16\u8f91",memo:"\u6dfb\u52a0\u4fbf\u7b3a"},headBtns:{new:"\u65b0\u5efa\u6d41\u7a0b",open:"\u6253\u5f00\u6d41\u7a0b",save:"\u4fdd\u5b58\u7ed3\u679c",undo:"\u64a4\u9500",redo:"\u91cd\u505a",reload:"\u5237\u65b0\u6d41\u7a0b",print:"\u6253\u5370\u6d41\u7a0b\u56fe"},extendRight:"\u5de5\u4f5c\u533a\u5411\u53f3\u6269\u5c55",extendBottom:"\u5de5\u4f5c\u533a\u5411\u4e0b\u6269\u5c55"},Q={color:{main:"#20A0FF",font:"#15428B",node:"#C0CCDA",line:"#1D8CE0",lineFont:"#ff6600",mark:"#ff8800",mix:"#B6F700",mixFont:"#777"},remarks:Y},Z={flag:"group",methods:{_initGroup:function(){if(this.$editable){F(this.$refs.$group,"contextmenu",".GooFlow_area",{inthis:this},function(t,e){var s=t.data.inthis;if("function"===typeof s.onItemRightClick&&!1===s.onItemRightClick(e.id,"area"))return t.preventDefault(),!1});var t=this;this.$refs.$group.addEventListener("mousedown",function(e){if(2===e.button)return!1;if("group"===t.state.$nowType&&"none"===t.$refs.$textArea.style.display&&(e||(e=window.event),"LABEL"!==e.target.tagName&&"I"!==e.target.tagName)){var s=A(e.target).cursor,i=e.target.parentNode;switch(s){case"nw-resize":case"w-resize":case"n-resize":i=i.parentNode;break;case"move":break;default:return}i=i.id,e.id=i,t.$refs.$ghost.css({cursor:s});var o=t.state.$areas[i];t._bindMoveEvent(e,o,function(e,s,o,a,r,n,l){e&&("move"!==o?t.resizeArea(i,n,l):t.moveArea(i,a,r,"bind"===document.getElementById(i).querySelector("em").className))},s,200,100)}}),this.$refs.$group.addEventListener("dblclick",function(e){if("group"===t.state.$nowType){if(e||(e=window.event),"LABEL"!==e.target.tagName)return!1;var s=e.target.parentNode;if("function"!==typeof t.onItemDbClick||!1!==t.onItemDbClick(s.id,"area")){var i=e.target.innerHTML,o=parseInt(s.style.left,10)+18,a=parseInt(s.style.top,10)+1,r=t.t;return t.$refs.$textArea.value=i,t._renameTxtShow({width:130,height:26,left:r.left+o-t.$refs.$workArea.parentNode.scrollLeft,top:r.top+a-t.$refs.$workArea.parentNode.scrollTop}),t.$refs.$textArea.setAttribute("data-id",s.id),t.$refs.$textArea.focus(),t.$refs.$workArea.parentNode.onmouseup=function(e){t.$refs.$workArea.parentNode.onmouseup=null,2!==e.button&&"block"===t.$refs.$textArea.style.display&&(t.setName(t.$refs.$textArea.getAttribute("data-id"),t.$refs.$textArea.value,"area"),t.$refs.$textArea.value="",t.$refs.$textArea.removeAttribute("data-id"),t.$refs.$textArea.style.display="none")},E(e),!1}}}),this.$refs.$group.addEventListener("mouseup",function(e){if("block"===t.$refs.$textArea.style.display)return t.setName(t.$refs.$textArea.getAttribute("data-id"),t.$refs.$textArea.value,"area"),t.$refs.$textArea.value="",t.$refs.$textArea.removeAttribute("data-id"),void(t.$refs.$textArea.style.display="none");if("group"===t.state.$nowType){switch(e||(e=window.event),e.target.className){case"rs_close":return t.delArea(e.target.parentNode.parentNode.id),E(e),!1;case"bg":return;case"bind":return e.target.className="unbind",E(e),!1;case"unbind":return e.target.className="bind",E(e),!1}switch(e.target.tagName){case"LABEL":return!1;case"I":var s=e.target.parentNode.id;switch(t.state.$areas[s].color){case"red":t.setAreaColor(s,"yellow");break;case"yellow":t.setAreaColor(s,"blue");break;case"blue":t.setAreaColor(s,"green");break;case"green":t.setAreaColor(s,"milk");break;case"milk":t.setAreaColor(s,"red")}return!1}if(!t.$dragAddOper&&"none"===t.$refs.$ghost.$el.style.display){if(2===e.button)return E(e),!1;var i=w(e),o=x(this),a=i.x-o.left+this.parentNode.parentNode.scrollLeft,r=i.y-o.top+this.parentNode.parentNode.scrollTop;return t.addArea((new Date).getTime(),{name:t.$areaPrefix+t.$max,left:a/t.scale,top:r/t.scale,color:["red","yellow","blue","green","milk"][t.$max%5],width:200,height:100}),t.$max++,E(e),!1}}})}},_areaFixNodes:function(t){var e=this.state.$areas[t];for(var s in this.state.$nodes){var i=this.state.$nodes[s];i.left>=e.left&&i.left<e.left+e.width&&i.top>=e.top&&i.top<e.top+e.height?i.areaId=t:i.areaId&&i.areaId===t&&this._node2Area(s)}},_syncGroupMove:function(t,e,s,i){var o=this.state.$areas[t],a=-1;if("object"!==typeof i){var r={nodeIds:[],lineIds:[]};for(var n in this.state.$nodes){var l=this.state.$nodes[n];l.areaId&&l.areaId===t&&(this.moveNode(n,l.left+e,l.top+s,!1,!0,!0),r.nodeIds.push(n))}for(var h in this.state.$lines){var c=this.state.$lines[h],p=document.getElementById(h),d=!1,u=p.getAttribute("from").split(",");u[0]=parseFloat(u[0]),u[1]=parseFloat(u[1]);var f=p.getAttribute("to").split(",");f[0]=parseFloat(f[0]),f[1]=parseFloat(f[1]),"sl"===c.type||("tb"===c.type?(u[1]=c.M,f[1]=c.M):"lr"===c.type&&(u[0]=c.M,f[0]=c.M));var m=u[0]>=o.left&&u[0]<=o.left+o.width&&u[1]>=o.top&&u[1]<=o.top+o.height,g=f[0]>=o.left&&f[0]<=o.left+o.width&&f[1]>=o.top&&f[1]<=o.top+o.height;if(m||g||("tb"===c.type?d=o.top<=f[1]&&f[1]<=o.top+o.height&&(u[0]<=o.left&&f[0]>=o.left+o.width||f[0]<=o.left&&u[0]>=o.left+o.width):"lr"===c.type&&(d=o.left<=f[0]&&f[0]<=o.left+o.width&&(u[1]<=o.top&&f[1]>=o.top+o.height||f[1]<=o.top&&u[1]>=o.top+o.height)),d))switch(c.type){case"sl":break;case"lr":c.Ml=s+c.Ml,c.Mr=s+c.Mr,a=e+c.M,c.M=-1,this.setLineM(h,a,!0,!1,!0),r.lineIds.push(h);break;case"tb":c.Ml=e+c.Ml,c.Mr=e+c.Mr,a=s+c.M,c.M=-1,this.setLineM(h,a,!0,!1,!0),r.lineIds.push(h)}}return r}for(var $=0;$<i.nodeIds.length;++$){var v=i.nodeIds[$],y=this.state.$nodes[v];this.moveNode(v,y.left+e,y.top+s,!1,!0,!0)}for(var b=0;b<i.lineIds.length;++b){var w=i.lineIds[b],x=this.state.$lines[w];switch(x.type){case"sl":break;case"lr":x.Ml=s+x.Ml,x.Mr=s+x.Mr,a=e+x.M,x.M=-1,this.setLineM(w,a,!0,!1,!0);break;case"tb":x.Ml=e+x.Ml,x.Mr=e+x.Mr,a=s+x.M,x.M=-1,this.setLineM(w,a,!0,!1,!0)}}return i},addArea:function(t,e,s,i,o,a){!1!==s&&"function"===typeof this.onItemAdd&&!1===this.onItemAdd(t,"area",e)||("function"===typeof this.pushOper&&!i&&this.$editable&&this.pushOper("delArea",[t]),this.$editable&&(e.alt=!0,this.$deletedItem[t]&&delete this.$deletedItem[t]),this.state.$areas[t]=e,a||this.setState({$areas:this.state.$areas}),this.$editable&&this._areaFixNodes(t),++this.$areaCount,!o&&this.$navMap&&this.$nextTick(function(){this.refreshMap()}))},delArea:function(t,e,s,i){if(this.state.$areas[t]&&(!1===e||"function"!==typeof this.onItemDel||!1!==this.onItemDel(t,"area"))){if("function"!==typeof this.pushOper||s||this.pushOper("addArea",[t,this.state.$areas[t]]),this.$editable){for(var o in this.state.$nodes){var a=this.state.$nodes[o];a.areaId===t&&delete a.areaId}this.$deletedItem[t]="area"}delete this.state.$areas[t],this.setState({$areas:this.state.$areas}),--this.$areaCount,!i&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},moveArea:function(t,e,s,i){if(this.state.$areas[t]&&(null==this.onItemMove||this.onItemMove(t,"area",e,s))){e<0&&(e=0),s<0&&(s=0);var o,a=this.state.$areas[t];o=!1!==i?this._syncGroupMove(t,e-a.left,s-a.top,i):i,"function"===typeof this.pushOper&&this.pushOper("moveArea",[t,a.left,a.top,o]),a.left=e,a.top=s,this.$editable&&(a.alt=!0,this._areaFixNodes(t)),this.state.$areas[t]=a;var r=document.getElementById(t);r.style.left=e*this.scale+"px",r.style.top=s*this.scale+"px",this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},setAreaColor:function(t,e){this.state.$areas[t]&&("red"!==e&&"yellow"!==e&&"blue"!==e&&"green"!==e&&"milk"!==e||("function"===typeof this.pushOper&&this.pushOper("setAreaColor",[t,this.state.$areas[t].color]),this.$editable&&(this.state.$areas[t].alt=!0),this.state.$areas[t].color=e,document.getElementById(t).className="GooFlow_area area_"+e+(this.drawingGroup()?"":" lock"),this.$navMap&&this.$nextTick(function(){this.refreshMap()})))},resizeArea:function(t,e,s){if(this.state.$areas[t]&&("function"!==typeof this.onItemResize||!1!==this.onItemResize(t,"area",e,s))){"function"===typeof this.pushOper&&this.pushOper("resizeArea",[t,this.state.$areas[t].width,this.state.$areas[t].height]);var i=document.getElementById(t);i.childNodes[0].style.width=e*this.scale+"px",i.childNodes[0].style.height=s*this.scale+"px",e=i.offsetWidth,s=i.offsetHeight;var o=this.state.$areas[t];o.width=e,o.height=s,this.$editable&&(o.alt=!0,this._areaFixNodes(t)),this.state.$areas[t]=o,this.$navMap&&this.$nextTick(function(){this.refreshMap()})}}}},tt={flag:"memo",events:{onMemoSetText:null},methods:{_initMemo:function(){if(this.$editable){F(this.$refs.$paper,"contextmenu",".GooFlow_memo",{inthis:this},function(t,e){var s=t.data.inthis;if("function"===typeof s.onItemRightClick&&!1===s.onItemRightClick(e.id,"memo"))return t.preventDefault(),!1});var t=this;this.$refs.$paper.addEventListener("mousedown",function(e){if(2===e.button)return!1;if("memo"===t.state.$nowType&&"none"===t.$refs.$textArea.style.display&&(e||(e=window.event),"memo_text"!==e.target.className)){var s=A(e.target).cursor,i=e.target.parentNode;switch(s){case"nw-resize":case"w-resize":case"n-resize":i=i.parentNode;break;case"move":break;default:return}e.id=i.id,t.$refs.$ghost.css({cursor:s});var o=t.state.$memos[i.id];t._bindMoveEvent(e,o,function(e,s,o,a,r,n,l){e&&("move"!==o?t.resizeMemo(i.id,n,l):t.moveMemo(i.id,a,r))},s,140,54)}}),F(this.$refs.$paper,"dblclick",".GooFlow_memo .memo_text",{inthis:this},function(e,s){if("memo"===t.state.$nowType){e||(e=window.event);var i=s.parentNode.parentNode;if("function"!==typeof t.onItemDbClick||!1!==t.onItemDbClick(i.id,"memo")){var o=e.target.innerHTML,a=parseInt(i.style.left,10)+10*t.scale,r=parseInt(i.style.top,10),n=t.t;return t.$refs.$textArea.value=o,t._renameTxtShow({width:s.offsetWidth+10*t.scale,height:s.offsetHeight+20*t.scale,left:n.left+a-t.$refs.$workArea.parentNode.scrollLeft,top:n.top+r-t.$refs.$workArea.parentNode.scrollTop}),t.$refs.$textArea.setAttribute("data-id",i.id),t.$refs.$textArea.focus(),t.$refs.$workArea.parentNode.onmouseup=function(e){t.$refs.$workArea.parentNode.onmouseup=null,2!==e.button&&"block"===t.$refs.$textArea.style.display&&(t.setMemoText(t.$refs.$textArea.getAttribute("data-id"),t.$refs.$textArea.value),t.$refs.$textArea.value="",t.$refs.$textArea.removeAttribute("data-id"),t.$refs.$textArea.style.display="none")},E(e),!1}}}),this.$refs.$paper.addEventListener("mouseup",function(e){if("block"===t.$refs.$textArea.style.display)return t.setMemoText(t.$refs.$textArea.getAttribute("data-id"),t.$refs.$textArea.value),t.$refs.$textArea.value="",t.$refs.$textArea.removeAttribute("data-id"),void(t.$refs.$textArea.style.display="none");if("memo"===t.state.$nowType){switch(e||(e=window.event),e.target.className){case"rs_close":return t.delMemo(e.target.parentNode.parentNode.id),E(e),!1;case"memo_text":case"memo_body":return}if(!t.$dragAddOper&&"none"===t.$refs.$ghost.$el.style.display){if(2===e.button)return E(e),!1;var s=w(e),i=x(this),o=s.x-i.left+this.parentNode.parentNode.scrollLeft,a=s.y-i.top+this.parentNode.parentNode.scrollTop;return t.addMemo((new Date).getTime(),{text:"",left:o/t.scale,top:a/t.scale,width:140,height:54}),E(e),!1}}})}},addMemo:function(t,e,s,i,o,a){!1!==s&&"function"===typeof this.onItemAdd&&!1===this.onItemAdd(t,"memo",e)||("function"===typeof this.pushOper&&!i&&this.$editable&&this.pushOper("delMemo",[t]),this.$editable&&(e.alt=!0,this.$deletedItem[t]&&delete this.$deletedItem[t]),this.state.$memos[t]=e,a||this.setState({$memos:this.state.$memos}),++this.$memoCount,!o&&this.$navMap&&this.$nextTick(function(){this.refreshMap()}))},delMemo:function(t,e,s,i){this.state.$memos[t]&&(!1!==e&&"function"===typeof this.onItemDel&&!1===this.onItemDel(t,"memo")||("function"!==typeof this.pushOper||s||this.pushOper("addMemo",[t,this.state.$memos[t]]),this.$editable&&(this.$deletedItem[t]="memo"),delete this.state.$memos[t],this.setState({$memos:this.state.$memos}),--this.$memoCount,!i&&this.$navMap&&this.$nextTick(function(){this.refreshMap()})))},moveMemo:function(t,e,s){if(this.state.$memos[t]&&(null==this.onItemMove||this.onItemMove(t,"memo",e,s))){"function"===typeof this.pushOper&&this.pushOper("moveMemo",[t,this.state.$memos[t].left,this.state.$memos[t].top]),e<0&&(e=0),s<0&&(s=0);var i=this.state.$memos[t];i.left=e,i.top=s,this.$editable&&(i.alt=!0),this.state.$memos[t]=i;var o=document.getElementById(t);o.style.left=e*this.scale+"px",o.style.top=s*this.scale+"px",this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},resizeMemo:function(t,e,s){if(this.state.$memos[t]&&("function"!==typeof this.onItemResize||!1!==this.onItemResize(t,"memo",e,s))){"function"===typeof this.pushOper&&this.pushOper("resizeMemo",[t,this.state.$memos[t].width,this.state.$memos[t].height]);var i=document.getElementById(t);i.childNodes[0].style.width=e*this.scale+"px",i.childNodes[0].style.height="auto";var o=i.offsetHeight;(s*=this.scale)<o&&(s=o),i.childNodes[0].style.height=s+"px";var a=this.state.$memos[t];a.width=e,a.height=s/this.scale,this.$editable&&(a.alt=!0),this.state.$memos[t]=a,this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},setMemoText:function(t,e){if(this.state.$memos[t]&&this.state.$memos[t].text!==e&&("function"!==typeof this.onMemoSetText||!1!==this.onMemoSetText(t,e))){var s=this.state.$memos[t],i=this.state.$memos[t].text;s.text=e;var o=document.getElementById(t);o.querySelector(".memo_text").innerHTML=e,o.childNodes[0].style.height="auto";var a=o.offsetWidth/this.scale,r=o.offsetHeight/this.scale;r<s.height&&(r=s.height),o.childNodes[0].style.height=r*this.scale+"px",s.width===a&&s.height===r||("function"===typeof this.pushOper&&this.pushOper("resizeMemo",[t,s.width,s.height]),s.width=a,s.height=r),this.$editable&&(s.alt=!0),this.state.$memos[t]=s,"function"===typeof this.pushOper&&this.pushOper("setMemoText",[t,i])}}}},et={flag:"autoalign",prop:{_amin:6},methods:{_locAlignLine:function(t,e,s){var i=[],o=this.$refs.$workArea.parentNode,a=o.scrollLeft-this.t.left,r=o.scrollTop-this.t.top;i="group"!==s&&"group"!==e.getData("type")||!this.extFlag.group?"memo"!==s&&"memo"!==e.getData("type")||!this.extFlag.memo?this.state.$nodes:this.state.$memos:this.state.$areas;var n={h:-1,hType:"",v:-1,vType:""},l=e.offsetSize(),h=parseInt(e.$el.style.left.split("px")[0],10)+a,c=parseInt(e.$el.style.top.split("px")[0],10)+r,p=l.width,d=l.height;for(var u in i)t!==u&&i.hasOwnProperty(u)&&(h+p/2>=(i[u].left+i[u].width/2)*this.scale-this._amin&&h+p/2<=(i[u].left+i[u].width/2)*this.scale+this._amin?(n.h=(i[u].left+i[u].width/2)*this.scale-o.scrollLeft,n.hType="center"):h+p>=i[u].left*this.scale-this._amin&&h+p<=i[u].left*this.scale+this._amin?(n.h=i[u].left*this.scale-o.scrollLeft,n.hType="right"):h>=i[u].left*this.scale-this._amin&&h<=i[u].left*this.scale+this._amin?(n.h=i[u].left*this.scale-o.scrollLeft,n.hType="left"):h+p>=(i[u].left+i[u].width)*this.scale-this._amin&&h+p<=(i[u].left+i[u].width)*this.scale+this._amin?(n.h=(i[u].left+i[u].width)*this.scale-o.scrollLeft,n.hType="right"):h>=(i[u].left+i[u].width)*this.scale-this._amin&&h<=(i[u].left+i[u].width)*this.scale+this._amin&&(n.h=(i[u].left+i[u].width)*this.scale-o.scrollLeft,n.hType="left"),c+d/2>=(i[u].top+i[u].height/2)*this.scale-this._amin&&c+d/2<=(i[u].top+i[u].height/2)*this.scale+this._amin?(n.v=(i[u].top+i[u].height/2)*this.scale-o.scrollTop,n.vType="middle"):c+d>=i[u].top*this.scale-this._amin&&c+d<=i[u].top*this.scale+this._amin?(n.v=i[u].top*this.scale-o.scrollTop,n.vType="bottom"):c>=i[u].top*this.scale-this._amin&&c<=i[u].top*this.scale+this._amin?(n.v=i[u].top*this.scale-o.scrollTop,n.vType="top"):c+d>=(i[u].top+i[u].height)*this.scale-this._amin&&c+d<=(i[u].top+i[u].height)*this.scale+this._amin?(n.v=(i[u].top+i[u].height)*this.scale-o.scrollTop,n.vType="bottom"):c>=(i[u].top+i[u].height)*this.scale-this._amin&&c<=(i[u].top+i[u].height)*this.scale+this._amin&&(n.v=(i[u].top+i[u].height)*this.scale-o.scrollTop,n.vType="top"));return n.h+=o.scrollLeft,n.v+=o.scrollTop,n},_magnetic:function(t,e){if(null==e||-1===e.v&&-1===e.h)return this.$refs.$alignH.style.display="none",void(this.$refs.$alignV.style.display="none");e.h>-1?(this.$refs.$alignH.style.display="block",this.$refs.$alignH.style.left=e.h+"px"):this.$refs.$alignH.style.display="none",e.v>-1?(this.$refs.$alignV.style.display="block",this.$refs.$alignV.style.top=e.v+"px"):this.$refs.$alignV.style.display="none";var s=t.offsetSize(),i=this.t.left-this.$refs.$workArea.parentNode.scrollLeft,o={left:t.$el.style.left,top:t.$el.style.top};switch(e.hType){case"center":o.left=e.h-s.width/2+i+"px";break;case"left":o.left=e.h+i+"px";break;case"right":o.left=e.h-s.width+i+"px"}switch(i=this.t.top-this.$refs.$workArea.parentNode.scrollTop,e.vType){case"middle":o.top=e.v-s.height/2+i+"px";break;case"top":o.top=e.v+i+"px";break;case"bottom":o.top=e.v-s.height+i+"px"}t.show(o)}}},st={flag:"print",methods:{print:function(t){var e=this._suitSize();t||(t=1),e.width+=100,e.height+=100;for(var s=this.$refs.$workArea.cloneNode(!0),i=["",".GooFlow_work_paper",".GooFlow_work_group","svg"],o=0;o<i.length;o++){var a=i[o],r=""===a?s:s.querySelector(a);r&&null!=r&&(r.style.width=e.width+"px",r.style.height=e.height+"px")}var n=document.createElement("div");n.className="GooFlow GooFlow_work",n.style.width=e.width+"px",n.style.height=e.height+"px",n.style.overflow="hidden",n.append(s),this.GooFlow.color.font&&(n.style.color=this.GooFlow.color.font),n.style.transform="scale("+t+")",n.style.transformOrigin="top left",function(t,e){var s={pageTitle:"",base:!1};Object.assign(s,e);var i="printThis-"+(new Date).getTime(),o=document.createElement("iframe");o.name="printIframe",o.id=i,document.body.appendChild(o),window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(o.className="MSIE",o.src="about:blank",o.document.write("<head><script>document.domain='"+document.domain+"';<\/script></head><body></body>"));var a=document.getElementById(i);L.css(a,{position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"}),setTimeout(function(){!function(t){var e=(t=t.contentWindow||t.contentDocument||t).document||t.contentDocument||t;e.open(),e.write("<!DOCTYPE html>"),e.close()}(a);var e=a.document||a.contentDocument||a,i=e.head,o=e.body,r=document.querySelector("base"),n="";L.css(o,{height:"auto",margin:"0",padding:"0",background:"#fff"}),n=!0===s.base&&null!=r?r.getAttribute("href"):"string"===typeof s.base?s.base:document.location.protocol+"//"+document.location.host;var l=e.createElement("base");l.setAttribute("href",n),i.appendChild(l);for(var h=document.querySelectorAll("link"),c=0;c<h.length;++c){var p=h[c].getAttribute("href");if(p&&null!=p&&""!==p){var d=h[c].getAttribute("media")||"all",u=h[c].cloneNode(!0);u.setAttribute("media",d),i.appendChild(u)}}for(var f=document.querySelectorAll("style"),m=0;m<f.length;++m){var g=f[m].cloneNode(!0);i.appendChild(g)}if(s.pageTitle){var $=e.createElement("title");$.innerHTML=s.pageTitle,i.appendChild($)}var v=t.cloneNode(!0);o.appendChild(v),setTimeout(function(){if(L.hasClass(a,"MSIE")){window.frames.printIframe.focus();var t=document.createElement("script");t.type="text/javascript",t.innerHTML="window.print();",i.appendChild(t)}else document.queryCommandSupported("print")?a.contentWindow.document.execCommand("print",!1,null):(a.contentWindow.focus(),a.contentWindow.print());setTimeout(function(){a.parentNode.removeChild(a)},1e3)},333)},333)}(n,{base:document.URL,pageTitle:this.$title})}}},it=s(8),ot=s.n(it),at="\u4ec5\u5728\u7ebf\u8bd5\u7528\u7248";s(13);var rt=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round mix","task","node","chat","state","plug","join","fork","complex mix"],toolTextWidth:60,auth:at},s.global=Q,s.plugIns=[Z,tt,et,st],s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"adfdsfasdfsdafasdf");return o.a.createElement("div",{id:"DemoBase"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()}})}}]),e}(o.a.Component),nt={flag:"dragadd",methods:{_initDragAddOper:function(){if(this.$editable&&this.$refs.$tool){var t=this;F(this.$refs.$tool.$el,"mousedown","li",{},function(e,s){var i=s.getAttribute("type"),o=s.title;if(t.$dragAddOper&&"cursor"!==i&&!C(i)){var a="",r=k(e,t.$refs.$workArea),n=t.$nodeCustoms[i],l={width:104,height:26,type:i,title:null!=o&&""!==o?o:"--------",left:r.X,top:r.Y,canOver:!0};if(void 0!==n&&null!=n){n.width&&(l.width=n.width),n.height&&(l.height=n.height);var h='<i class="'+n.class+'" style="width:'+l.width+"px;height:"+l.height+'px;"></i>';a='<table cellspacing="0" style="width:'+l.width*t.scale+"px;height:"+l.height*t.scale+'px;margin:-1px"><tr><td class="ico">'+h+"</td></tr></table>"}else l.type.indexOf(" round")>-1?(l.width=26,l.height=26,l.title=""):l.type.indexOf(" rhomb")>0?(l.width=30,l.height=30,l.title=""):"group"===l.type?(l.width=200,l.height=100):"memo"===l.type?(l.width=140,l.height=54):a='<table cellspacing="1" style="width:'+(l.width*t.scale-2)+"px;height:"+(l.height*t.scale-2)+'px;"><tr><td class="ico"><i class="ico_'+l.type+'"></i></td><td><div>'+l.title+"</div></td></tr></table>";""===a&&(a='<table cellspacing="0" style="width:'+(l.width*t.scale-2)+"px;height:"+(l.height*t.scale-2)+'px;"><tr><td class="ico"><i class="ico_'+l.type+'"></i> '+l.title+"</td></tr></table>"),t.$refs.$ghost.setData("type",i),t.$refs.$ghost.html(a),t.$refs.$ghost.css({cursor:"move"}),t._bindMoveEvent(e,l,function(e,s,i,o,a){if(s.$refs.$ghost.removeData("type"),!(o<0||a<0)&&e){if("group"===l.type){s.switchToolBtn("group");s.addArea((new Date).getTime(),{name:s.$areaPrefix+s.$max,left:o/s.scale,top:a/s.scale,color:["red","yellow","blue","green","milk"][s.$max%5],width:200,height:100})}else"memo"===l.type?(s.switchToolBtn("memo"),s.addMemo((new Date).getTime(),{text:"",left:o/s.scale,top:a/s.scale,width:140,height:54})):(s.switchToolBtn("cursor"),t.addNode((new Date).getTime(),{name:s.$nodePrefix+s.$max,left:o/s.scale,top:a/s.scale,width:l.width,height:l.height,type:l.type}));s.$max++}},"move",l.width,l.height)}})}}}};s(13),s(16);var lt=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,dragAddOper:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round","task","node","huber","router","plug2"],nodeCustoms:{huber:{class:"custom_huber",width:102,height:50},router:{class:"custom_router",width:115,height:52}},auth:at},s.global=Q,s.plugIns=[Z,tt,et,nt,st],s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u62d6\u62fd\u5f0f\u6dfb\u52a0\u5757\u72b6\u5143\u7d20\u64cd\u4f5c\u65b9\u5f0f");return o.a.createElement("div",{id:"DemoDragadd"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()}})}}]),e}(o.a.Component);s(13);var ht=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"900",height:"600",haveHead:!0,headLabel:!0,haveTool:!1,toolBtns:["start round mix","end round","task","node","chat","state","plug","join","fork","complex mix"],auth:at},s.global=Q,s.plugIns=[Z,tt,et,st],s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u53ea\u8bfb\u6a21\u5f0f-\u624b\u52a8\u6807\u6ce8\u6f14\u793a");return o.a.createElement("div",{id:"DemoReadonly"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onItemFocus:function(e,s){var i=null;if("node"===s)i=t.state.$nodes[e];else{if("line"!==s)return;i=t.state.$lines[e]}return t.markItem(e,s,!i.marked),!1}})}}]),e}(o.a.Component),ct=function(){CanvasRenderingContext2D.prototype.roundRect=function(t,e,s,i,o){return s<2*o&&(o=s/2),i<2*o&&(o=i/2),this.beginPath(),this.moveTo(t+o,e),this.arcTo(t+s,e,t+s,e+i,o),this.arcTo(t+s,e+i,t,e+i,o),this.arcTo(t,e+i,t,e,o),this.arcTo(t,e,t+s,e,o),this.closePath(),this},CanvasRenderingContext2D.prototype.BezierEllipse=function(t,e,s,i){var o=.5522848,a=s*o,r=i*o;return this.beginPath(),this.moveTo(t-s,e),this.bezierCurveTo(t-s,e-r,t-a,e-i,t,e-i),this.bezierCurveTo(t+a,e-i,t+s,e-r,t+s,e),this.bezierCurveTo(t+s,e+r,t+a,e+i,t,e+i),this.bezierCurveTo(t-a,e+i,t-s,e+r,t-s,e),this.closePath(),this}},pt={canvasExtend:function(){ct()},initBg:function(t,e,s){var i=document.createElement("canvas");i.width=t,i.height=e;var o=i.getContext("2d");return s&&(o.fillStyle=s),o.fillRect(0,0,i.width,i.height),o.save(),i},_toNum:function(t){return null!==t&&""!==t?parseInt(t.split("px")[0],10):void 0},_analyseLabel:function(t){var e=t.tagName,s=t.offsetLeft,i=t.offsetTop,o=null;if("TD"===e){var a=t.querySelector("div"),r=A(a);s+=a.offsetLeft-this._toNum(r.marginLeft),i+=a.offsetTop-this._toNum(r.marginTop),o=r.transform}else o=t.style.transform;var n=A(t),l=this._toNum(n.lineHeight),h=n.fontSize;return{isMemo:!!L.hasClass(t,"memo_text")||void 0,font:"14px "+n.fontFamily,fontFamily:n.fontFamily,fontSize:this._toNum(h.split("px")[0]),text:t.innerText,color:n.color,width:t.offsetWidth,height:t.offsetHeight,transform:o,lineHeight:l,offsetLeft:s,offsetTop:i,lineNum:Math.ceil(t.offsetHeight/l)}},_analyseIcon:function(t){var e=A(t),s=e.backgroundImage,i={offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight};return s&&"none"!==s?(s=s.replace(/"/g,"").split("url(")[1],i.backgroundImage=s.substr(0,s.length-1),s=e.backgroundPosition.split(" "),i.pX=-1*parseFloat(s[0].split("px")[0]),i.pY=-1*parseFloat(s[1].split("px")[0]),i.offsetLeft=t.parentNode.offsetLeft,i.offsetTop=t.parentNode.offsetTop):Object.assign(i,{font:"18px "+e.fontFamily.split(" ")[0],lineHeight:this._toNum(e.lineHeight),color:e.color,opacity:parseFloat(e.opacity),content:window.getComputedStyle(t,"::before").getPropertyValue("content")}),i},_fillIcon:function(t,e,s,i,o,a){var r=t.getContext("2d");if(void 0===i.backgroundImage){0===i.content.indexOf('"')&&(i.content=i.content.split('"')[1]),i.color=i.color.replace("rgb","rgba").replace(")",", "+i.opacity+")"),r.fillStyle=i.color,r.font=i.font,r.textAlign="center",r.textBaseline="middle";var n=window.ActiveXObject||"ActiveXObject"in window?0:1,l=e+i.offsetLeft+4+i.width/2+n,h=s+i.offsetTop+2+i.height/2+n;return r.save(),r.translate(l,h),r.scale(a,a),r.fillText(i.content,0,0),r.restore(),null}r.save();var c=0,p=0;i.pX<0&&(c-=i.pX,i.pX=0),i.pY<0&&(p-=i.pY,i.pY=0);var d=i.isCustom?0:2*a;r.drawImage(o,i.pX,i.pY,i.width,i.height,e+i.offsetLeft+d+c,s+i.offsetTop+d+p,i.width*a,i.height*a),r.restore()},_fillLabel:function(t,e,s,i,o,a){var r=t.getContext("2d");r.fillStyle=i.color,r.textAlign="center",i.isMemo&&(r.textAlign="left"),r.font=i.font,r.textBaseline="top";var n=i.text,l=0,h=0,c=window.ActiveXObject||"ActiveXObject"in window?1:3,p=e+i.offsetLeft+(i.isMemo?0:i.width/2)+c/2,d=s+i.offsetTop+c;a&&(p-=a.x,d+=a.y),navigator.userAgent.indexOf("Firefox")>=0&&(d+=i.lineHeight-i.fontSize),r.save(),r.translate(p,d),d=0,p=0,r.scale(o,o);for(var u=0;u<n.length;u++)l+=r.measureText(n[u]).width,u!==n.length-1?l>=i.width/o&&(r.fillText(n.substring(h,u),p,d),d+=i.lineHeight,l=0,h=u):r.fillText(n.substring(h,u+1),p,d);r.restore()},_analyseArea:function(t){var e=t.querySelector(".bg"),s=A(e);return{top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,borderColor:s.borderTopColor,bgColor:s.backgroundColor,opacity:parseFloat(s.opacity),icon:this._analyseIcon(t.querySelector("i")),label:this._analyseLabel(t.querySelector("label"))}},renderAreas:function(t,e,s,i){var o=t.getContext("2d");for(var a in e){var r=e[a];r.bgColor=r.bgColor.replace("rgb","rgba").replace(")",", "+r.opacity+")"),r.borderColor=r.borderColor.replace("rgb","rgba").replace(")",", "+r.opacity+")"),o.fillStyle=r.bgColor,o.strokeStyle=r.borderColor,o.rect(r.left,r.top,r.width,r.height),o.fill(),o.stroke(),this._fillIcon(t,r.left-3,r.top-3,r.icon,s,i),this._fillLabel(t,r.left,r.top,r.label,i)}},_analyseMemo:function(t){var e=this._analyseIcon(t.querySelector("i"));e.font="14px "+e.font.split(" ")[1];var s=this._analyseLabel(t.querySelector(".memo_text"));s.font="12px "+s.fontFamily;var i=A(t);return{top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,bgColor:i.color,boxShadow:i.boxShadow,icon:e,label:s}},renderMemos:function(t,e,s){var i=t.getContext("2d");for(var o in e){var a=e[o];i.save(),i.fillStyle=a.bgColor;var r=a.boxShadow.split(") ");i.shadowColor=r[0],r=r[1].split(" "),i.shadowOffsetX=this._toNum(r[0]),i.shadowOffsetY=this._toNum(r[1]),i.shadowBlur=this._toNum(r[2]),i.beginPath(),i.moveTo(a.left+10,a.top),i.lineTo(a.left+a.width,a.top),i.lineTo(a.left+a.width,a.top+a.height),i.lineTo(a.left,a.top+a.height),i.lineTo(a.left,a.top+10),i.lineTo(a.left+10,a.top),i.closePath(),i.fill(),i.restore(),i.save(),i.fillStyle="rgba(0,0,0,0.1)",i.beginPath(),i.moveTo(a.left+10,a.top),i.lineTo(a.left+10,a.top+10),i.lineTo(a.left,a.top+10),i.lineTo(a.left+10,a.top),i.closePath(),i.fill(),i.restore(),i.save(),i.fillStyle=a.icon.color,i.font=a.icon.font,i.textAlign="center",i.textBaseline="middle";var n=a.left+a.width/2,l=a.top+2;i.translate(n,l),i.scale(s,s),0===a.icon.content.indexOf('"')&&(a.icon.content=a.icon.content.split('"')[1]),i.fillText(a.icon.content,0,0),i.restore(),this._fillLabel(t,a.left,a.top,a.label,s)}},_analyseNode:function(t){var e="";L.hasClass(t,"item_ellipse")&&(e="ellipse"),L.hasClass(t,"item_rhomb")&&(e="rhomb"),L.hasClass(t,"item_round")&&(e="round"),L.hasClass(t,"item_parallelogram")&&(e="parallelogram"),L.hasClass(t,"item_custom")&&(e="custom");var s=A(t),i={top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,borderColor:s.borderTopColor,borderWidth:this._toNum(s.borderTopWidth),bgColor:s.backgroundColor,borderRadius:this._toNum(s.borderTopLeftRadius),boxShadow:s.boxShadow,spClass:e,icon:this._analyseIcon(t.querySelector(".ico").childNodes[0])};return L.hasClass(t,"item_round")||L.hasClass(t,"item_rhomb")||L.hasClass(t,"item_custom")?i.label=this._analyseLabel(t.querySelector(".span")):i.label=this._analyseLabel(t.querySelector("td").nextSibling),"custom"===e&&(i.icon.isCustom=!0),i},renderNodes:function(t,e,s,i){var o=t.getContext("2d");for(var a in e){var r=e[a],n=r.boxShadow.split(") ");if(1===n.length){var l=r.boxShadow.split("rgba");n[0]="rgba"+l[1],n[1]=l[0]}"custom"!==r.spClass&&(o.shadowColor=n[0],n=n[1].split(" "),o.shadowOffsetX=this._toNum(n[0])+(r.borderWidth>1?1:0),o.shadowOffsetY=this._toNum(n[1])+(r.borderWidth>1?1:0),o.shadowBlur=this._toNum(n[2])),o.fillStyle=r.bgColor,"ellipse"===r.spClass?o.BezierEllipse(r.left+r.width/2,r.top+r.height/2,r.width/2,r.height/2).fill():"rhomb"===r.spClass?(o.save(),o.translate(r.left+r.width/2,r.top+r.height/2),o.rotate(45*Math.PI/180),o.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),o.restore()):"parallelogram"===r.spClass?(o.save(),o.translate(r.left+r.width/2,r.top+r.height/2),o.transform(1,0,-12/r.height,1,0,0),o.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),o.restore()):"custom"===r.spClass||o.roundRect(r.left+r.borderWidth/2,r.top+r.borderWidth/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),o.shadowBlur=0,o.shadowColor="",o.shadowOffsetX=0,o.shadowOffsetY=0,o.strokeStyle=r.borderColor,o.lineWidth=0===r.borderWidth?.01:r.borderWidth,o.stroke(),this._fillIcon(t,r.left+(r.borderRadius>6?-3:0),r.top,r.icon,s,i),this._fillLabel(t,r.left,r.top,r.label,i,"rhomb"===r.spClass?{x:r.width/3*1.41,y:r.height/4}:void 0)}},_analyseLine:function(t,e){var s=A(t).fontFamily,i=e.querySelector("path[stroke-linecap]"),o=i.getAttribute("marker-end"),a={color:i.getAttribute("stroke"),lineWidth:i.getAttribute("stroke-width"),lineCap:"round",noArrow:!o||null==o},r=i.style.strokeDasharray;a.lineDash=r&&null!=r;var n=e.childNodes[2],l=n.getAttribute("fill");l&&null!==l&&""!==l||(l="#777"),a.label={text:n.textContent,font:n.style.fontSize+" "+s,color:l,left:n.getAttribute("x"),top:n.getAttribute("y")};for(var h=i.getAttribute("d"),c=h.substring(2,h.length).split(/[L|Q]/),p=[],d=0;d<c.length;++d){c[d]=c[d].replace(/^\s+|\s+$/gm,"");var u=c[d].split(" ");2===u.length?p.push({x:parseFloat(u[0]),y:parseFloat(u[1])}):p.push({x:parseFloat(u[0]),y:parseFloat(u[1]),dX:parseFloat(u[2]),dY:parseFloat(u[3])})}a.points=p;var f=p.length,m=p[f-1].x-p[f-2].x,g=p[f-1].y-p[f-2].y;return a.angle=Math.atan2(g,m),a},renderLines:function(t,e){var s=t.getContext("2d");for(var i in e){var o=e[i];s.save(),s.setLineDash(o.lineDash?[4,6]:[]),s.strokeStyle=o.color,s.lineWidth=o.lineWidth,s.lineCap=o.lineCap;var a=o.points;s.beginPath(),s.moveTo(a[0].x,a[0].y);for(var r=1;r<a.length;++r)if(a[r].dX){var n=a[r].y===a[r].dY?Math.abs(a[r].x-a[r].dX):Math.abs(a[r].y-a[r].dY);s.arcTo(a[r].x,a[r].y,a[r].dX,a[r].dY,n),s.moveTo(a[r].dX,a[r].dY)}else s.lineTo(a[r].x,a[r].y),r!==a.length-1&&s.moveTo(a[r].x,a[r].y);if(s.closePath(),s.stroke(),o.noArrow||(s.translate(a[a.length-1].x,a[a.length-1].y),s.rotate(o.angle),s.fillStyle=o.color,s.beginPath(),s.moveTo(1*o.lineWidth,0),s.lineTo(-6*o.lineWidth,-3*o.lineWidth),s.lineTo(-6*o.lineWidth,3*o.lineWidth),s.lineTo(1*o.lineWidth,0),s.closePath(),s.fill()),s.restore(),o.label&&null!=o.label.text&&""!==o.label.text){var l=t.getContext("2d"),h=o.label;l.fillStyle=h.color,l.textAlign="center",l.font=h.font,l.fillText(h.text,h.left,h.top)}}}};function dt(t,e,s){try{var i=new Blob([t]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,e+"."+s);else{var o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=e+"."+s,o.click(),window.URL.revokeObjectURL(o.href)}}catch(r){for(var a=window.open("","_blank");"complete"!==a.document.readyState&&"complete"!==a.document.readyState;);a.document.write("<html><head><title>"+e+"."+s+"</title></head><body><pre>"+("xml"===s?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t)+"</pre></body></html>")}}var ut={flag:"export",initFuncName:"canvasExtend",methods:{canvasExtend:function(){pt.canvasExtend()},exportDiagram:function(t){for(var e=void 0,s=null,i={},o=this.$refs.$group.querySelectorAll(".GooFlow_area"),a=0;a<o.length;++a)i[o[a].id]=pt._analyseArea(o[a]),i[o[a].id].icon.backgroundImage&&null===s&&(s=i[o[a].id].icon.backgroundImage);for(var r={},n=this.$refs.$paper.querySelectorAll(".GooFlow_memo"),l=0;l<n.length;++l)r[n[l].id]=pt._analyseMemo(n[l]);for(var h={},c=this.$refs.$workArea.querySelectorAll(".GooFlow_item"),p=0;p<c.length;++p)h[c[p].id]=pt._analyseNode(c[p]),h[c[p].id].icon.backgroundImage&&null===s&&(s=h[c[p].id].icon.backgroundImage);var d=this._suitSize(),u=d.width+100*this.scale,f=d.height+100*this.scale,m=pt.initBg(u,f,"#ffffff"),g=this;null!==s&&((e=new Image).setAttribute("crossOrigin","anonymous"),e.src=s);var $=function(){o.length>0&&pt.renderAreas(m,i,e,g.scale),n.length>0&&pt.renderMemos(m,r,g.scale),pt.renderNodes(m,h,e,g.scale);var s=m.getContext("2d");if(s.restore(),window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("Edge")>-1){for(var a={},l=this.$refs.$draw.querySelectorAll("g"),c=0;c<l.length;++c)"GooFlow_tmp_line"!==l[c].getAttribute("tid")&&(a[l[c].id]=pt._analyseLine(g.$el,l[c]));pt.renderLines(m,a);try{var p=m.msToBlob();navigator.msSaveBlob(p,t+".png")}catch(b){for(var d=m.toDataURL("image/png"),$=window.open("","_blank");"complete"!==$.document.readyState&&"complete"!==$.document.readyState;);$.document.write("<html><head><title>"+t+'.png</title></head><body><img src="'+d+'" border="1" title="'+t+'.png"></body></html>')}}else{var v='<svg xmlns="http://www.w3.org/2000/svg" width="'+u+'" height="'+f+'"><defs><style type="text/css">text{font-size:14px;line-height:1.42857143;font-family:"Microsoft Yahei", "Helvetica Neue", Helvetica, Hiragino Sans GB, WenQuanYi Micro Hei, Arial, sans-serif;}</style></defs>'+g.$refs.$draw.innerHTML+"</svg>",y=new Image;y.src="data:image/svg+xml,"+encodeURIComponent(v),y.onload=function(){s.drawImage(y,0,0);var e=document.createElementNS("http://www.w3.org/1999/xhtml","a");e.href=m.toDataURL("image/png"),e.download=t+".png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}};!e||e.complete||window.ActiveXObject||"ActiveXObject"in window?$():e.onload=function(){$()}},exportDataFile:function(t,e){if("json"===e)dt(JSON.stringify(this.exportData()),t,"json");else{if("xml"!==e)return;try{dt(this.exportBpmnXML(),t,"xml")}catch(s){console.warn("failed in exec function exportBpmnXML()! you need extend the xml.js plugin for supported.")}}}}};s(13);var ft=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round mix","task","node capsule","chat parallelogram","state","plug","join rhomb","fork rhomb","complex ellipse mix"],toolTextWidth:60,auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,ut],s.exportDiagram=s.exportDiagram.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u7279\u6b8a\u5f62\u72b6\u7684\u8282\u70b9 ",o.a.createElement("button",{type:"button",onClick:this.exportDiagram},"\u5bfc\u51fa\u6d41\u7a0b\u56fe\u7247"));return o.a.createElement("div",{id:"DemoSpnode"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"exportDiagram",value:function(){this.gooFlow.exportDiagram("myFlow")}},{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data3.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()},onBtnSaveClick:function(){t.exportDiagram("myFlow")}})}}]),e}(o.a.Component);s(13),s(16);var mt=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"800",height:"500",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["huber","router","plug2","complex mix"],nodeCustoms:{huber:{class:"custom_huber",width:102,height:50},router:{class:"custom_router",width:115,height:52}},auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,ut],s.exportDiagram=s.exportDiagram.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u81ea\u5b9a\u4e49\u80cc\u666f\u56fe\u8282\u70b9 ",o.a.createElement("button",{type:"button",onClick:this.exportDiagram},"\u5bfc\u51fa\u6d41\u7a0b\u56fe\u7247"));return o.a.createElement("div",{id:"DemoCustom"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"exportDiagram",value:function(){this.gooFlow.exportDiagram("myFlow")}},{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data3.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()},onBtnSaveClick:function(){t.exportDiagram("myFlow")}})}}]),e}(o.a.Component);Object.keys=Object.keys||function(t){var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(s);return e};var gt={flag:"multi",prop:{$multiNodes:{},$multiLines:{},$multiKey:"shift"},events:{onBatchAdd:null,onBatchDel:null,onBatchMove:null,onBatchMark:null},methods:{_isMultiKey:function(t){return!(!t.shiftKey||"shift"!==this.$multiKey)||!(!t.ctrlKey||"ctrl"!==this.$multiKey)},_wallAllMulti:function(){if(this.$multiNodes&&this.$multiLines){if(0===Object.keys(this.$multiNodes).length&&0===Object.keys(this.$multiLines).length)return this.$refs.$multiGhost.hide(),void this.$refs.$multiOper.hide();var t=0,e=0,s=-1,i=-1;for(var o in this.$multiNodes){var a=this.state.$nodes[o];(-1===s||a.left<s)&&(s=a.left),(-1===i||a.top<i)&&(i=a.top),a.width+a.left>t&&(t=a.width+a.left),a.height+a.top>e&&(e=a.height+a.top)}for(var r in this.$multiLines){var n=this.state.$lines[r],l=document.getElementById(r),h=l.getAttribute("from").split(","),c=[];c[0]=parseFloat(h[0]),c[1]=parseFloat(h[1]);var p=l.getAttribute("to").split(","),d=[];d[0]=parseFloat(p[0]),d[1]=parseFloat(p[1]),"sl"===n.type||("tb"===n.type?(c[1]=n.M,d[1]=n.M):"lr"===n.type&&(c[0]=n.M,d[0]=n.M)),(-1===s||c[0]<s)&&(s=c[0]),(-1===s||d[0]<s)&&(s=d[0]),(-1===i||c[1]<i)&&(i=c[1]),(-1===i||d[1]<i)&&(i=d[1]),c[0]>t&&(t=c[0]),d[0]>t&&(t=d[0]),c[1]>e&&(e=c[1]),d[1]>e&&(e=d[1])}this.$refs.$multiGhost.show({left:s-2+"px",top:i-2+"px",width:t-s+4+"px",height:e-i+4+"px"}),this.$refs.$multiOper.show({left:t+4+"px",top:i-2+"px"})}},_addtoMultiList:function(t,e,s){var i=null;"node"===e?(this.$multiNodes[t]=t,i=document.getElementById(t),L.addClass(i,"item_focus"),i.style.borderColor=this.GooFlow.color.line):"line"===e&&(this.$multiLines[t]=t,(i=document.getElementById(t).querySelector("path[stroke-linecap='round']")).setAttribute("stroke","#ff8800"),this.state.$lines[t].noArrow||i.setAttribute("marker-end","url(#arrow2)")),s&&this._wallAllMulti()},_removeFromMultiList:function(t,e,s){var i=null,o=null;if("node"===e){delete this.$multiNodes[t],i=document.getElementById(t),L.removeClass(i,"item_focus"),o=this.state.$nodes[t];var a=this.$nodeTypeMap[o.type]||o.type;o.marked?(L.addClass(i,"item_mark"),i.style.borderColor=this.GooFlow.color.mark):a.indexOf(" mix")>0?i.style.borderColor=this.GooFlow.color.mix:this.$nodeCustoms[a]?i.style.borderColor="transparent":i.style.borderColor=this.state.$nodes[t].color||this.GooFlow.color.node}else"line"===e&&(delete this.$multiLines[t],o=this.state.$lines[t],i=document.getElementById(t).querySelector("path[stroke-linecap='round']"),o.marked||(i.setAttribute("stroke",o.color||this.GooFlow.color.line),o.noArrow||i.setAttribute("marker-end","url(#arrow1)")));s&&this._wallAllMulti()},_clearMultiList:function(){for(var t in this.$multiNodes)this._removeFromMultiList(t,"node");for(var e in this.$multiLines)this._removeFromMultiList(e,"line");this._wallAllMulti()},_initMultiSelect:function(t){var e=this;e.$multiKey=t,this.$refs.$workArea.addEventListener("mousedown",function(t){var s={X:0,Y:0};if("cursor"===e.state.$nowType){if(e._isMultiKey(t))return!1;if(e.$refs.$multiGhost.inShow()){if(0===Object.keys(e.$multiLines).length&&0===Object.keys(e.$multiNodes).length)return void e._wallAllMulti();var i=e.$refs.$multiGhost.position(),o=e.$refs.$multiGhost.offsetSize();if(!((s=k(t,this)).X<i.left||s.X>i.left+o.width||s.Y<i.top||s.Y>i.top+o.height))return o.left=i.left,o.top=i.top,void e._bindMoveEvent(t,o,function(t,e,s,i,a){t&&e.batchMove(e.$multiNodes,e.$multiLines,i-o.left,a-o.top),e._wallAllMulti()});var a=t.target,r=a.tagName;if(!("svg"===r||"DIV"===r&&a.className.indexOf("GooFlow_work")>-1||"LABEL"===r))return;e.$refs.$multiGhost.show({left:s.X+"px",top:s.Y+"px",width:"0px",height:"0px"}),e.$refs.$multiOper.hide()}else{var n=t.target,l=n.tagName;if(!("svg"===l||"DIV"===l&&n.className.indexOf("GooFlow_work")>-1||"LABEL"===l))return;s=k(t,this),e.$refs.$multiGhost.show({left:s.X+"px",top:s.Y+"px",width:"0",height:"0"}),e.$refs.$multiOper.hide()}var h=!1;document.onmousemove=function(t){t||(t=window.event);var i=k(t,e.$refs.$workArea),o=i.X-s.X,a=i.Y-s.Y,r=e.$refs.$multiGhost.position();o<0&&(r.left=s.X+o,o*=-1),a<0&&(r.top=s.Y+a,a*=-1),h=!0,e.$refs.$multiGhost.css({left:r.left+"px",top:r.top+"px",width:o+"px",height:a+"px"})},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null;var s=e.$refs.$multiGhost.position(),i=e.$refs.$multiGhost.offsetSize(),o=s.left,a=s.top,r=i.width,n=i.height;if(""!==e.state.$focus&&e.blurItem(!1),e._clearMultiList(),h){for(var l in e.state.$nodes){var c=e.state.$nodes[l],p={left:c.left*e.scale,top:c.top*e.scale,right:(c.left+c.width)*e.scale,bottom:(c.top+c.height)*e.scale};if(!(p.left>=o&&p.left<=o+r||p.right>=o&&p.right<=o+r)||!(p.top>=a&&p.top<=a+n||p.bottom>=a&&p.bottom<=a+n))if(!(p.left<=o&&p.right>=o+r&&(a<=p.top&&a+n>=p.top||a<=p.bottom&&a+n>=p.bottom))&&!(p.top<=a&&p.bottom>=a+n&&(o<=p.left&&o+r>=p.left||o<=p.right&&o+r>=p.right)))continue;e._addtoMultiList(l,"node")}for(var d in e.state.$lines){var u,f,m=e.state.$lines[d],g=void 0,$=document.getElementById(d),v=$.getAttribute("from").split(","),y=[];y[0]=parseFloat(v[0]),y[1]=parseFloat(v[1]);var b=$.getAttribute("to").split(","),w=[];w[0]=parseFloat(b[0]),w[1]=parseFloat(b[1]),"sl"===m.type||("tb"===m.type?(y[1]=m.M,w[1]=m.M):"lr"===m.type&&(y[0]=m.M,w[0]=m.M)),u=y[0]>=o&&y[0]<=o+r&&y[1]>=a&&y[1]<=a+n,f=w[0]>=o&&w[0]<=o+r&&w[1]>=a&&w[1]<=a+n,(u||f||("tb"===m.type?g=a<=w[1]&&w[1]<=a+n&&(y[0]<=o&&w[0]>=o+r||w[0]<=o&&y[0]>=o+r):"lr"===m.type&&(g=o<=w[0]&&w[0]<=o+r&&(y[1]<=a&&w[1]>=a+n||w[1]<=a&&y[1]>=a+n)),g))&&e._addtoMultiList(d,"line")}e._wallAllMulti(),E(t)}}}})},batchMarkItem:function(t,e,s){if("function"!==typeof this.onBatchMark||!1!==this.onBatchMark(t,e,s)){if("object"===typeof t&&"number"===typeof t.length&&t.length>0)for(var i=0;i<t.length;++i)this.markItem(t[i],s,!1,!0,!0);if("object"===typeof e&&"number"===typeof e.length&&e.length>0)for(var o=0;o<e.length;++o)this.markItem(e[o],s,!1,!0,!0);"function"===typeof this.pushOper&&this.pushOper("batchMarkItem",[t,e,s]),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},batchAddItem:function(t,e){if("function"!==typeof this.onBatchAdd||!1!==this.onBatchAdd(t,e)){var s=[],i=[];for(var o in t)this.addNode(o,t[o],!1,!0,!0),i.push(o);for(var a in e)this.addLine(a,e[a],!1,!0,!0),s.push(a);"function"===typeof this.pushOper&&this.$editable&&this.pushOper("batchDelete",[i,s]),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},batchDelete:function(t,e){if("function"!==typeof this.onBatchDel||!1!==this.onBatchDel(t,e)){var s={},i={};if("object"===typeof t&&"number"===typeof t.length&&t.length>0)for(var o=0;o<t.length;++o)if(this.state.$nodes[t[o]]&&null!=this.state.$nodes[t[o]]){for(var a in i[t[o]]=JSON.parse(JSON.stringify(this.state.$nodes[t[o]])),this.state.$lines)this.state.$lines[a].from!==t[o]&&this.state.$lines[a].to!==t[o]||(s[a]=JSON.parse(JSON.stringify(this.state.$lines[a])),this.delLine(a,!1,!0,!0),this.$multiLines&&delete this.$multiLines[a]);this.delNode(t[o],!1,!0,!0),this.$multiNodes&&delete this.$multiNodes[t[o]]}if("object"===typeof e&&"number"===typeof e.length&&e.length>0)for(var r=0;r<e.length;++r)this.state.$lines[e[r]]&&null!=this.state.$lines[e[r]]&&(s[e[r]]=JSON.parse(JSON.stringify(this.state.$lines[e[r]])),this.delLine(e[r],!1,!0,!0),this.$multiLines&&delete this.$multiLines[e[r]]);"function"===typeof this.pushOper&&this.$editable&&this.pushOper("batchAddItem",[i,s]),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}},batchMove:function(t,e,s,i){if((0!==Object.keys(t).length||0!==Object.keys(e).length)&&"number"===typeof s&&"number"===typeof i&&("function"!==typeof this.onBatchMove||!1!==this.onBatchMove(t,e,s,i))){var o={},a={};if("object"===typeof t)for(var r in t){var n=this.state.$nodes[r];n&&null!=n&&(this.moveNode(r,n.left+s,n.top+i,!1,!0,!0),o[r]=r)}if("object"===typeof e)for(var l in e){var h=this.state.$lines[l];if(h&&null!=h&&("lr"===h.type||"tb"===h.type)){h.Ml="lr"===h.type?i+h.Ml:s+h.Ml,h.Mr="lr"===h.type?i+h.Mr:s+h.Mr;var c="lr"===h.type?s+h.M:i+h.M;h.M=-1,this.setLineM(l,c,!0,!1,!0),a[l]=l}}"function"===typeof this.pushOper&&this.$editable&&this.pushOper("batchMove",[o,a,-1*s,-1*i]),this.$navMap&&this.$nextTick(function(){this.refreshMap()})}}}};s(13);var $t=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"multi_demo",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round","task","node","chat","state","plug","join","fork","complex mix"],toolTextWidth:60,multiKey:"ctrl",auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,gt],s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u591a\u9009\u5b9e\u9a8c");return o.a.createElement("div",{id:"DemoMulti"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()}})}}]),e}(o.a.Component),vt={canvasExtend:function(){ct()},_toNum:function(t){return null!==t&&""!==t?parseInt(t.split("px")[0],10):void 0},_analyseArea:function(t){var e=t.querySelector(".bg"),s=A(e);return{top:this._toNum(t.style.top),left:this._toNum(t.style.left),width:t.offsetWidth,height:t.offsetHeight,borderColor:s.borderTopColor,bgColor:s.backgroundColor,opacity:parseFloat(s.opacity)}},renderAreas:function(t,e,s){for(var i in e){var o=e[i];t.save(),o.bgColor=o.bgColor.replace("rgb","rgba").replace(")",", "+o.opacity+")"),o.borderColor=o.borderColor.replace("rgb","rgba").replace(")",", "+o.opacity+")"),t.fillStyle=o.bgColor,t.strokeStyle=o.borderColor,t.beginPath(),t.rect(o.left*s,o.top*s,o.width*s,o.height*s),t.fill(),t.stroke(),t.closePath(),t.restore()}},_analyseMemo:function(t,e){var s=A(t);return{top:this._toNum(t.style.top)*e,left:this._toNum(t.style.left)*e,width:t.offsetWidth*e,height:t.offsetHeight*e,bgColor:s.color}},renderMemos:function(t,e){for(var s in e){var i=e[s];t.save(),t.fillStyle=i.bgColor,t.beginPath(),t.moveTo(i.left+5,i.top),t.lineTo(i.left+i.width,i.top),t.lineTo(i.left+i.width,i.top+i.height),t.lineTo(i.left,i.top+i.height),t.lineTo(i.left,i.top+5),t.lineTo(i.left+5,i.top),t.closePath(),t.fill(),t.restore(),t.save(),t.fillStyle="rgba(0,0,0,0.1)",t.beginPath(),t.moveTo(i.left+5,i.top),t.lineTo(i.left+5,i.top+5),t.lineTo(i.left,i.top+5),t.lineTo(i.left+5,i.top),t.closePath(),t.fill(),t.restore()}},_analyseNode:function(t,e){var s="";L.hasClass(t,"item_ellipse")&&(s="ellipse"),L.hasClass(t,"item_rhomb")&&(s="rhomb"),L.hasClass(t,"item_round")&&(s="round"),L.hasClass(t,"item_parallelogram")&&(s="parallelogram"),L.hasClass(t,"item_custom")&&(s="custom");var i=A(t),o={top:this._toNum(t.style.top)*e,left:this._toNum(t.style.left)*e,width:t.offsetWidth*e,height:t.offsetHeight*e,borderColor:i.borderTopColor,borderWidth:this._toNum(i.borderTopWidth)*e,bgColor:i.backgroundColor,borderRadius:this._toNum(i.borderTopLeftRadius),spClass:s};return"custom"===s&&(o.borderColor="#999999"),o},renderNodes:function(t,e){for(var s in t.save(),e){var i=e[s];t.fillStyle=i.bgColor,"ellipse"===i.spClass?t.BezierEllipse(i.left+i.width/2,i.top+i.height/2,i.width/2,i.height/2).fill():"rhomb"===i.spClass?(t.save(),t.translate(i.left+i.width/2,i.top+i.height/2),t.rotate(45*Math.PI/180),t.roundRect(-i.width/2,-i.height/2,i.width-i.borderWidth,i.height-i.borderWidth,i.borderRadius).fill(),t.restore()):"parallelogram"===i.spClass?(t.save(),t.translate(i.left+i.width/2,i.top+i.height/2),t.transform(1,0,-12/i.height,1,0,0),t.roundRect(-i.width/2,-i.height/2,i.width-i.borderWidth,i.height-i.borderWidth,i.borderRadius).fill(),t.restore()):"custom"===i.spClass?(t.save(),t.strokeStyle=i.borderColor,t.lineCap="round",t.roundRect(i.left,i.top,i.width,i.height,i.borderRadius).stroke(),t.beginPath(),t.moveTo(i.left+2,i.top+2),t.lineTo(i.left+i.width-2,i.top+i.height-2),t.moveTo(i.left+2,i.top+i.height-2),t.lineTo(i.left+i.width-2,i.top+2),t.closePath(),t.stroke(),t.restore()):t.roundRect(i.left,i.top,i.width,i.height,i.borderRadius).fill(),"custom"!==i.spClass&&(t.strokeStyle=i.borderColor,t.lineWidth=0!==i.borderWidth?i.borderWidth:.1,t.stroke())}t.restore()},_analyseLine:function(t,e){var s=t.querySelector("path[stroke-linecap]"),i=s.getAttribute("marker-end"),o={color:s.getAttribute("stroke"),lineWidth:s.getAttribute("stroke-width")*e,lineCap:"round",noArrow:!i||null==i},a=s.style.strokeDasharray;o.lineDash=a&&null!=a;for(var r=s.getAttribute("d"),n=r.substring(2,r.length).split(/[L|Q]/),l=[],h=0;h<n.length;++h){n[h]=n[h].replace(/^\s+|\s+$/gm,"");var c=n[h].split(" ");2===c.length?l.push({x:parseFloat(c[0])*e,y:parseFloat(c[1])*e}):l.push({x:parseFloat(c[0])*e,y:parseFloat(c[1])*e,dX:parseFloat(c[2])*e,dY:parseFloat(c[3])*e})}o.points=l;var p=l.length,d=l[p-1].x-l[p-2].x,u=l[p-1].y-l[p-2].y;return o.angle=Math.atan2(u,d),o},renderLines:function(t,e){for(var s in e){var i=e[s];t.save(),t.setLineDash(i.lineDash?[2,3]:[]),t.strokeStyle=i.color,t.lineWidth=i.lineWidth,t.lineCap=i.lineCap;var o=i.points;t.beginPath(),t.moveTo(o[0].x,o[0].y);for(var a=1;a<o.length;++a)if(o[a].dX){var r=o[a].y===o[a].dY?Math.abs(o[a].x-o[a].dX):Math.abs(o[a].y-o[a].dY);t.arcTo(o[a].x,o[a].y,o[a].dX,o[a].dY,r),t.moveTo(o[a].dX,o[a].dY)}else t.lineTo(o[a].x,o[a].y),a!==o.length-1&&t.moveTo(o[a].x,o[a].y);t.closePath(),t.stroke(),i.noArrow||(t.translate(o[o.length-1].x,o[o.length-1].y),t.rotate(i.angle),t.fillStyle=i.color,t.beginPath(),t.moveTo(1*i.lineWidth,0),t.lineTo(-6*i.lineWidth,-3*i.lineWidth),t.lineTo(-6*i.lineWidth,3*i.lineWidth),t.lineTo(1*i.lineWidth,0),t.closePath(),t.fill()),t.restore()}},_clearMap:function(t){t.getContext("2d").clearRect(0,0,parseInt(t.getAttribute("width")),parseInt(t.getAttribute("height")));var e=t.nextSibling;e&&null!=e&&"viewbox"===e.className&&(e.style.top=0,e.style.left=0,e.style.width="100%",e.style.height="100%")}},yt={flag:"navmap",initFuncName:"canvasExtend",methods:{canvasExtend:function(){vt.canvasExtend()},_locateViewBox:function(t){var e=this.$navMap.querySelector(".viewbox"),s=this.$refs.$workArea.parentNode,i=s.scrollLeft*t,o=s.scrollTop*t;e.style.left=i+"px",e.style.top=o+"px",e.style.width=s.clientWidth*t+"px",e.style.height=s.clientHeight*t+"px"},refreshMap:function(){var t=this.$navMap.querySelector("canvas"),e=t.getContext("2d");vt._clearMap(t);var s=this._buildWorkSize();if(s.haveData){var i=t.width/s.width>t.height/s.height?t.height/s.height:t.width/s.width;this.$navMap.setAttribute("scale",""+i);for(var o={},a=this.$refs.$group.querySelectorAll(".GooFlow_area"),r=0;r<a.length;++r)o[a[r].id]=vt._analyseArea(a[r]);vt.renderAreas(e,o,i);for(var n={},l=this.$refs.$paper.querySelectorAll(".GooFlow_memo"),h=0;h<l.length;++h)n[l[h].id]=vt._analyseMemo(l[h],i);vt.renderMemos(e,n);for(var c={},p=this.$refs.$workArea.querySelectorAll(".GooFlow_item"),d=0;d<p.length;++d)c[p[d].id]=vt._analyseNode(p[d],i);vt.renderNodes(e,c);for(var u={},f=this.$refs.$draw.querySelectorAll("g"),m=0;m<f.length;++m)"GooFlow_tmp_line"!==f[m].getAttribute("tid")&&(u[f[m].id]=vt._analyseLine(f[m],i));vt.renderLines(e,u),this._locateViewBox(i)}},_initNavMap:function(t){if(t&&null!=t&&""!==t)if(this.$navMap=document.querySelector(t),this.$navMap&&null!=this.$navMap){var e=this.$navMap.clientWidth,s=this.$navMap.clientHeight;this.$navMap.className="GooFlow_nav_map",this.$navMap.style.width=e+"px",this.$navMap.style.height=s+"px",this.$navMap.setAttribute("unselectable","on"),this.$navMap.setAttribute("onselectstart","return false"),this.$navMap.setAttribute("onselect","document.selection.empty()");var i=document.createElement("canvas");i.className="map",i.width=e,i.height=s,this.$navMap.appendChild(i),(window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("Edge")>-1)&&(i=window.G_vmlCanvasManager.initElement(i));var o=document.createElement("div");o.className="viewbox",this.$navMap.appendChild(o);var a=this;this.$refs.$workArea.parentNode.addEventListener("scroll",function(t){a._locateViewBox(parseFloat(a.$navMap.getAttribute("scale")))}),this.$navMap.querySelector(".viewbox").addEventListener("mousedown",function(t){this.parentNode.setAttribute("isDown","1");var e=w(t),s=a.$refs.$workArea.parentNode,i=e.x,o=e.y,r=s.scrollLeft,n=s.scrollTop,l=parseFloat(this.parentNode.getAttribute("scale"));document.onmousemove=function(t){if("1"===a.$navMap.getAttribute("isDown")){t||(t=window.event);var e=w(t);if(i===e.x&&o===e.y)return!1;s.scrollLeft=r+(e.x-i)/l,s.scrollTop=n+(e.y-o)/l}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,a.$navMap.removeAttribute("isDown")}})}else delete this.$navMap}}};s(13),s(16);var bt=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"800",height:"500",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["huber","router","plug2","complex mix"],nodeCustoms:{huber:{class:"custom_huber",width:102,height:50},router:{class:"custom_router",width:115,height:52}},auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,ut,yt],s.exportDiagram=s.exportDiagram.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},"\u5b9e\u65f6\u7684\u7f29\u7565\u5bfc\u822a\u56fe ",o.a.createElement("button",{type:"button",onClick:this.exportDiagram},"\u5bfc\u51fa\u6d41\u7a0b\u56fe\u7247"));return o.a.createElement("div",{id:"DemoNavmap"},o.a.createElement("div",{style:{float:"left",width:"800px"}},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,navSelector:"#demo_navmap",ref:function(e){return t.gooFlow=e}})),o.a.createElement("div",{style:{float:"left",width:"280px",border:"1px solid #999",backgroundColor:"#fff"}},o.a.createElement("div",{id:"demo_navmap",style:{height:"180px"}})))}}]),Object(l.a)(e,[{key:"exportDiagram",value:function(){this.gooFlow.exportDiagram("myFlow")}},{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/child.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()},onBtnSaveClick:function(){t.exportDiagram("myFlow")}})}}]),e}(o.a.Component);s(13);var wt=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"multi_demo",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round","task","node","chat","state","plug","join","fork","complex mix"],toolTextWidth:60,auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,ut],s.exportDiagram=s.exportDiagram.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},o.a.createElement("button",{type:"button",onClick:this.exportDiagram},"\u5bfc\u51fa\u6d41\u7a0b\u56fe\u7247"));return o.a.createElement("div",{id:"DemoExport"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}))}}]),Object(l.a)(e,[{key:"exportDiagram",value:function(){this.gooFlow.exportDiagram("myFlow")}},{key:"componentDidMount",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then(function(e){t.loadData(e.data)}),t.bindOperEvent({onPrintClick:function(){t.print()},onBtnSaveClick:function(){t.exportDiagram("myFlow")}})}}]),e}(o.a.Component),xt="    ",kt=xt+xt,Mt=kt+xt,_t='<?xml version="1.0" encoding="UTF-8"?>\n<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"\n'+xt+'xmlns:activiti="http://activiti.org/bpmn"\n'+xt+'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n'+xt+'targetNamespace="$#targetNamespace#"\n'+xt+'xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL\n'+xt+'http://www.omg.org/spec/BPMN/2.0/20100501/BPMN20.xsd">\n';function Nt(t,e,s){var i=s.left+","+s.top+","+s.width+","+s.height;return kt+"<"+e+' id="'+t+'" g="'+i+'"'}function Ot(t,e,s,i){var o=(i?"":"\n")+s+"<"+t,a="",r="",n=!1;for(var l in e)"object"===typeof e[l]?r+=Ot(l,e[l],s+xt):"text"===l?(r+=e[l],n=!0):a+=" "+l+'="'+e[l]+'"';return""===r||n||(r+="\n"+s),o+=a+(""===r?"/>":">"+r+"</"+t+">")}function Et(t,e){for(var s=0;s<t.attributes.length;++s){var i=t.attributes[s];"id"!==i.nodeName&&(e[i.nodeName]=(o=i.nodeValue,!isNaN(parseFloat(o))&&isFinite(o)?parseFloat(o):"true"===o||"false"!==o&&o))}var o;if(1===t.childNodes.length&&"string"===typeof t.childNodes[0].data)e.text=t.childNodes[0].data;else for(var a=0;a<t.childNodes.length;++a){var r=t.childNodes[a];"string"!==typeof r.data&&(e[r.tagName]={},Et(r,e[r.tagName]))}}var Ct={flag:"xml",methods:{exportBpmnXML:function(t){"undefined"===typeof t&&(t={});var e=_t.replace("$#targetNamespace#",this.$extra.targetNamespace||"Examples");for(var s in this.$extra)if("targetNamespace"!==s&&"id"!==s){var i=this.$extra[s];e+="object"===typeof i?Ot(s,i,xt,!0)+"\n":xt+"<"+s+">"+i+"</"+s+">\n"}var o=this.$extra.id||"myProcess",a=this.$title||"My Process";for(var r in e+=xt+"<initNum>"+this.$max+"</initNum>\n",e+=xt+'<process id="'+o+'" name="'+a+'">\n',this.state.$areas){var n=this.state.$areas[r];e+=Nt(r,"swimlane",n),e+=' name="'+r+'" title="'+n.name+'"';var l="";for(var h in n)"left"!==h&&"top"!==h&&"width"!==h&&"height"!==h&&"name"!==h&&("object"===typeof n[h]?l+=Ot(h,n[h],Mt):e+=" "+h+'="'+n[h]+'"');e+=""===l?"/>\n":">"+l+"\n"+kt+"</swimlane>\n"}for(var c in this.state.$memos){var p=this.state.$memos[c];e+=Nt(c,"memo",p),e+=">"+p.text+"\n"+kt+"</memo>\n"}for(var d in this.state.$nodes){var u=this.state.$nodes[d],f=t[u.type]||u.type;e+=Nt(d,f,u);var m="";for(var g in u)"left"===g||"top"===g||"width"===g||"height"===g||"type"===g||("areaId"===g&&null!=u.areaId?e+=' swimlane="'+u.areaId+'"':"object"===typeof u[g]?m+=Ot(g,u[g],Mt):e+=" "+g+'="'+u[g]+'"');e+=""===m?"/>\n":">"+m+"\n"+kt+"</"+f+">\n"}for(var $ in this.state.$lines){var v=this.state.$lines[$];e+=kt+'<sequenceFlow id="'+$+'" sourceRef="'+v.from+'" targetRef="'+v.to+'"';var y="";for(var b in v)"from"!==b&&"to"!==b&&("object"===typeof v[b]?y+=Ot(b,v[b],Mt):e+=" "+b+'="'+v[b]+'"');e+=""===y?"/>\n":">"+y+"\n"+kt+"</sequenceFlow>\n"}return e+=xt+"</process>\n</definitions>"},loadBpmnXML:function(t,e){"undefined"===typeof e&&(e={});var s={extra:{}};if("string"===typeof t){var i=t;if(window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("Edge")>-1)(t=new(window.ActivexObject||function(){this.loadXML=function(){}})("MSXML2.DOMDocument")).loadXML(i);else t=(new DOMParser).parseFromString(i,"text/xml")}var o=t.getElementsByTagName("definitions")[0];s.extra.targetNamespace=o.getAttribute("targetNamespace");for(var a=0;a<o.childNodes.length;a++){var r=o.childNodes[a];if("string"!==typeof r.data){var n=r.tagName;if("process"!==n){if("initNum"===n){s.initNum=parseInt(r.textContent,10);continue}s.extra[n]={},r.childNodes.length>0&&"string"===typeof r.childNodes[0].data?s.extra[n]=r.childNodes[0].data:Et(r,s.extra[n])}else{s.extra.id=r.getAttribute("id"),s.title=r.getAttribute("name"),s.lines={},s.nodes={},s.areas={};for(var l=0;l<r.childNodes.length;++l){var h=r.childNodes[l];if("string"!==typeof h.data){var c=h.tagName,p=h.getAttribute("id");if("swimlane"===c){s.areas[p]={},Et(h,s.areas[p]),delete s.areas[p].id,s.areas[p].name=s.areas[p].title,delete s.areas[p].title;var d=s.areas[p].g.split(",");delete s.areas[p].g,s.areas[p].left=parseFloat(d[0]),s.areas[p].top=parseFloat(d[1]),s.areas[p].width=parseFloat(d[2]),s.areas[p].height=parseFloat(d[3])}else if("memo"===c){"object"!==typeof s.memos&&(s.memos={}),s.memos[p]={},Et(h,s.memos[p]),delete s.memos[p].id;var u=s.memos[p].g.split(",");delete s.memos[p].g,s.memos[p].left=parseFloat(u[0]),s.memos[p].top=parseFloat(u[1]),s.memos[p].width=parseFloat(u[2]),s.memos[p].height=parseFloat(u[3])}else if("sequenceFlow"===c)s.lines[p]={},Et(h,s.lines[p]),delete s.lines[p].id,s.lines[p].from=s.lines[p].sourceRef,s.lines[p].to=s.lines[p].targetRef,delete s.lines[p].sourceRef,delete s.lines[p].targetRef;else{s.nodes[p]={},Et(h,s.nodes[p]),delete s.nodes[p].id,"undefined"!==typeof s.nodes[p].swimlane&&(s.nodes[p].areaId=s.nodes[p].swimlane,delete s.nodes[p].swimlane);var f=s.nodes[p].g.split(",");delete s.nodes[p].g,s.nodes[p].left=parseFloat(f[0]),s.nodes[p].top=parseFloat(f[1]),s.nodes[p].width=parseFloat(f[2]),s.nodes[p].height=parseFloat(f[3]),s.nodes[p].type=e[h.tagName]||h.tagName}}}}}}this.loadData(s)}}};s(13);var At=function(t){function e(t){var s;return Object(n.a)(this,e),(s=Object(h.a)(this,Object(c.a)(e).call(this,t))).gooFlow=null,s.myProps={id:"aaaabbb",width:"900",height:"430",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round","task","node","state","complex mix"],toolTextWidth:60,auth:at},s.global=Q,s.plugIns=[Z,tt,et,st,Ct,ut],s.exportXml=s.exportXml.bind(Object(v.a)(Object(v.a)(s))),s.loadXmlAjax=s.loadXmlAjax.bind(Object(v.a)(Object(v.a)(s))),s.DownloadFile=s.DownloadFile.bind(Object(v.a)(Object(v.a)(s))),s}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=o.a.createElement("div",{style:{float:"right",marginRight:"15px"}},o.a.createElement("button",{type:"button",onClick:this.loadXmlAjax},"AJAX\u8f7d\u5165XML\u6570\u636e"),o.a.createElement("button",{type:"button",onClick:this.exportXml},"\u5bfc\u51faXML\u6570\u636e"),o.a.createElement("button",{type:"button",onClick:this.DownloadFile.bind(this,"flowJson","json")},"\u4e0b\u8f7dJSON"),o.a.createElement("button",{type:"button",onClick:this.DownloadFile.bind(this,"flowXml","xml")},"\u4e0b\u8f7dXML"));return o.a.createElement("div",{id:"DemoXml"},o.a.createElement(K,{property:this.myProps,global:this.global,plugIns:this.plugIns,headerCustom:e,ref:function(e){return t.gooFlow=e}}),o.a.createElement("textarea",{style:{width:"900px",height:"200px"},id:"xmlResult",readOnly:!0}))}}]),Object(l.a)(e,[{key:"DownloadFile",value:function(t,e){this.gooFlow.exportDataFile(t,e)}},{key:"exportXml",value:function(){document.getElementById("xmlResult").value=this.gooFlow.exportBpmnXML({"start round mix":"startEvent","end round mix":"endEvent"})}},{key:"loadXmlAjax",value:function(){var t=this.gooFlow;ot.a.get("./demo/data2.xml",{}).then(function(e){t.loadBpmnXML(e.data,{startEvent:"start round mix",endEvent:"end round mix"})})}},{key:"componentDidMount",value:function(){this.loadXmlAjax()}}]),e}(o.a.Component),St=function(t){function e(){return Object(n.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement(d.a,null,o.a.createElement("div",null,o.a.createElement("ul",{className:"nav"},o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/"},"Home")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/base"},"\u57fa\u672c\u529f\u80fd\u4f7f\u7528")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/dragadd"},"\u62d6\u62fd\u64cd\u4f5c\u65b9\u5f0f\u6dfb\u52a0\u5757\u5143\u7d20")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/readonly"},"\u53ea\u8bfb\u6a21\u5f0f")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/spnode"},"\u7279\u6b8a\u5f62\u72b6\u7684\u8282\u70b9")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/custom"},"\u81ea\u5b9a\u4e49\u80cc\u666f\u56fe\u8282\u70b9")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/multi"},"\u591a\u9009\u529f\u80fd\u64cd\u4f5c")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/navmap"},"\u5b9e\u65f6\u7684\u7f29\u7565\u5bfc\u822a\u56fe")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/export"},"\u5bfc\u51fa\u6d41\u7a0b\u56fe\u7247")),o.a.createElement("li",null,o.a.createElement(u.a,{exact:!0,activeClassName:"selected",to:"/xml"},"BPMN2.0 XML\u6570\u636e\u652f\u6301"))),o.a.createElement("div",{className:"content"},o.a.createElement(f.a,{path:"/",exact:!0,component:$}),o.a.createElement(f.a,{path:"/base",exact:!0,component:rt}),o.a.createElement(f.a,{path:"/dragadd",exact:!0,component:lt}),o.a.createElement(f.a,{path:"/readonly",exact:!0,component:ht}),o.a.createElement(f.a,{path:"/spnode",exact:!0,component:ft}),o.a.createElement(f.a,{path:"/custom",exact:!0,component:mt}),o.a.createElement(f.a,{path:"/multi",exact:!0,component:$t}),o.a.createElement(f.a,{path:"/navmap",exact:!0,component:bt}),o.a.createElement(f.a,{path:"/export",exact:!0,component:wt}),o.a.createElement(f.a,{path:"/xml",exact:!0,component:At}))))}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(St,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[26,2,1]]]);